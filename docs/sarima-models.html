<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 SARIMA Models | Time Series Analysis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 SARIMA Models | Time Series Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="shang-chieh0830/Time_Series_Analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 SARIMA Models | Time Series Analysis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Shang Chieh" />


<meta name="date" content="2023-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arima-model-building.html"/>
<link rel="next" href="arfima.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-operation"><i class="fa fa-check"></i><b>2.1</b> Basic Operation</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.2</b> Vectors</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#files"><i class="fa fa-check"></i><b>2.3</b> Files</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#regression"><i class="fa fa-check"></i><b>2.4</b> Regression</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#object-oriented-language"><i class="fa fa-check"></i><b>2.5</b> Object-Oriented Language</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>3</b> Plotting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting.html"><a href="plotting.html#example-data"><i class="fa fa-check"></i><b>3.1</b> Example Data</a></li>
<li class="chapter" data-level="3.2" data-path="plotting.html"><a href="plotting.html#sp500-index"><i class="fa fa-check"></i><b>3.2</b> S&amp;P500 Index</a></li>
<li class="chapter" data-level="3.3" data-path="plotting.html"><a href="plotting.html#sunspots"><i class="fa fa-check"></i><b>3.3</b> Sunspots</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="plotting.html"><a href="plotting.html#plot.ts"><i class="fa fa-check"></i><b>3.3.1</b> plot.ts()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-model.html"><a href="basic-model.html"><i class="fa fa-check"></i><b>4</b> Basic Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-model.html"><a href="basic-model.html#white-noise"><i class="fa fa-check"></i><b>4.1</b> White Noise</a></li>
<li class="chapter" data-level="4.2" data-path="basic-model.html"><a href="basic-model.html#moving-average"><i class="fa fa-check"></i><b>4.2</b> Moving Average</a></li>
<li class="chapter" data-level="4.3" data-path="basic-model.html"><a href="basic-model.html#autoregression"><i class="fa fa-check"></i><b>4.3</b> Autoregression</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dependence.html"><a href="dependence.html"><i class="fa fa-check"></i><b>5</b> Dependence</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dependence.html"><a href="dependence.html#autocovariance-function"><i class="fa fa-check"></i><b>5.1</b> Autocovariance function</a></li>
<li class="chapter" data-level="5.2" data-path="dependence.html"><a href="dependence.html#autocorrelation-function-acf"><i class="fa fa-check"></i><b>5.2</b> Autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="5.3" data-path="dependence.html"><a href="dependence.html#strong-positive-and-negative-linear-dependence"><i class="fa fa-check"></i><b>5.3</b> Strong positive and negative linear dependence</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stationarity.html"><a href="stationarity.html"><i class="fa fa-check"></i><b>6</b> Stationarity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stationarity.html"><a href="stationarity.html#stationarity-1"><i class="fa fa-check"></i><b>6.1</b> Stationarity</a></li>
<li class="chapter" data-level="6.2" data-path="stationarity.html"><a href="stationarity.html#linear-process"><i class="fa fa-check"></i><b>6.2</b> Linear Process</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html"><i class="fa fa-check"></i><b>7</b> Estimation and Inference for measures of dependence</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sample-mean-function"><i class="fa fa-check"></i><b>7.1</b> Sample mean function</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sample-autocovariance-function"><i class="fa fa-check"></i><b>7.2</b> Sample autocovariance function</a></li>
<li class="chapter" data-level="7.3" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sample-autocorrelation-function-acf"><i class="fa fa-check"></i><b>7.3</b> Sample autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="7.4" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sampling-distribution"><i class="fa fa-check"></i><b>7.4</b> Sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html"><i class="fa fa-check"></i><b>8</b> Resolving Non-Stationarity Problems</a>
<ul>
<li class="chapter" data-level="8.1" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#differencing"><i class="fa fa-check"></i><b>8.1</b> Differencing</a></li>
<li class="chapter" data-level="8.2" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#backshift-operator"><i class="fa fa-check"></i><b>8.2</b> Backshift Operator</a></li>
<li class="chapter" data-level="8.3" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#fractional-differencing"><i class="fa fa-check"></i><b>8.3</b> Fractional Differencing</a></li>
<li class="chapter" data-level="8.4" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#transformations"><i class="fa fa-check"></i><b>8.4</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="autoregressive-models.html"><a href="autoregressive-models.html"><i class="fa fa-check"></i><b>9</b> Autoregressive Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="autoregressive-models.html"><a href="autoregressive-models.html#ar-models"><i class="fa fa-check"></i><b>9.1</b> AR Models</a></li>
<li class="chapter" data-level="9.2" data-path="autoregressive-models.html"><a href="autoregressive-models.html#autoregressive-models-arp"><i class="fa fa-check"></i><b>9.2</b> Autoregressive models – AR(p)</a></li>
<li class="chapter" data-level="9.3" data-path="autoregressive-models.html"><a href="autoregressive-models.html#causal-process"><i class="fa fa-check"></i><b>9.3</b> Causal Process</a></li>
<li class="chapter" data-level="9.4" data-path="autoregressive-models.html"><a href="autoregressive-models.html#writing-higher-order-casual-models-as-x_tsum_j0inftypsi_jbjw_t"><i class="fa fa-check"></i><b>9.4</b> Writing higher-order casual models as <span class="math inline">\(x_t=\sum_{j=0}^{\infty}\psi_jB^jw_t\)</span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>10</b> Moving Average Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="moving-average-models.html"><a href="moving-average-models.html#moving-average-models-maq"><i class="fa fa-check"></i><b>10.1</b> Moving Average models-MA(q)</a></li>
<li class="chapter" data-level="10.2" data-path="moving-average-models.html"><a href="moving-average-models.html#invertible-process"><i class="fa fa-check"></i><b>10.2</b> Invertible process</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="arma.html"><a href="arma.html"><i class="fa fa-check"></i><b>11</b> ARMA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="arma.html"><a href="arma.html#autoregressive-moving-averagearma"><i class="fa fa-check"></i><b>11.1</b> Autoregressive Moving Average(ARMA)</a></li>
<li class="chapter" data-level="11.2" data-path="arma.html"><a href="arma.html#causality-of-an-armapq-process"><i class="fa fa-check"></i><b>11.2</b> Causality of an ARMA(p,q) process</a></li>
<li class="chapter" data-level="11.3" data-path="arma.html"><a href="arma.html#invertibility-of-armapq-process"><i class="fa fa-check"></i><b>11.3</b> Invertibility of ARMA(p,q) process</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="acf-and-pacf-for-arma-models.html"><a href="acf-and-pacf-for-arma-models.html"><i class="fa fa-check"></i><b>12</b> ACF and PACF for ARMA models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="acf-and-pacf-for-arma-models.html"><a href="acf-and-pacf-for-arma-models.html#acf-for-maq"><i class="fa fa-check"></i><b>12.1</b> ACF for MA(q)</a></li>
<li class="chapter" data-level="12.2" data-path="acf-and-pacf-for-arma-models.html"><a href="acf-and-pacf-for-arma-models.html#acf-for-casual-armapq"><i class="fa fa-check"></i><b>12.2</b> ACF for casual ARMA(p,q)</a></li>
<li class="chapter" data-level="12.3" data-path="acf-and-pacf-for-arma-models.html"><a href="acf-and-pacf-for-arma-models.html#pacf-for-arma-models"><i class="fa fa-check"></i><b>12.3</b> PACF for ARMA models</a></li>
<li class="chapter" data-level="12.4" data-path="acf-and-pacf-for-arma-models.html"><a href="acf-and-pacf-for-arma-models.html#compare-true-to-estimated-acfs-and-pacfs"><i class="fa fa-check"></i><b>12.4</b> Compare True to Estimated ACFs and PACFs</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="integrated-models-for-nonstationary-data.html"><a href="integrated-models-for-nonstationary-data.html"><i class="fa fa-check"></i><b>13</b> Integrated Models for Nonstationary Data</a></li>
<li class="chapter" data-level="14" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>14</b> Estimation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="estimation.html"><a href="estimation.html#method-of-moments-estimates"><i class="fa fa-check"></i><b>14.1</b> Method of moments estimates</a></li>
<li class="chapter" data-level="14.2" data-path="estimation.html"><a href="estimation.html#maximum-likelihood"><i class="fa fa-check"></i><b>14.2</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="14.3" data-path="estimation.html"><a href="estimation.html#likelihood-function"><i class="fa fa-check"></i><b>14.3</b> Likelihood function</a></li>
<li class="chapter" data-level="14.4" data-path="estimation.html"><a href="estimation.html#newton-raphson-method"><i class="fa fa-check"></i><b>14.4</b> Newton-Raphson method</a></li>
<li class="chapter" data-level="14.5" data-path="estimation.html"><a href="estimation.html#covariance-matrix-for-the-estimators"><i class="fa fa-check"></i><b>14.5</b> Covariance matrix for the estimators</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>15</b> Forecasting</a>
<ul>
<li class="chapter" data-level="15.1" data-path="forecasting.html"><a href="forecasting.html#point-estimates"><i class="fa fa-check"></i><b>15.1</b> Point Estimates</a></li>
<li class="chapter" data-level="15.2" data-path="forecasting.html"><a href="forecasting.html#inference"><i class="fa fa-check"></i><b>15.2</b> Inference</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="drift-term.html"><a href="drift-term.html"><i class="fa fa-check"></i><b>16</b> Drift Term</a>
<ul>
<li class="chapter" data-level="16.1" data-path="drift-term.html"><a href="drift-term.html#random-walk-model"><i class="fa fa-check"></i><b>16.1</b> Random Walk Model</a></li>
<li class="chapter" data-level="16.2" data-path="drift-term.html"><a href="drift-term.html#estimating-the-drift-term"><i class="fa fa-check"></i><b>16.2</b> Estimating the drift term</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="arima-model-building.html"><a href="arima-model-building.html"><i class="fa fa-check"></i><b>17</b> ARIMA Model Building</a>
<ul>
<li class="chapter" data-level="17.1" data-path="arima-model-building.html"><a href="arima-model-building.html#steps"><i class="fa fa-check"></i><b>17.1</b> Steps</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="arima-model-building.html"><a href="arima-model-building.html#model-building-process-steps-1-3-of-6-total-steps"><i class="fa fa-check"></i><b>17.1.1</b> Model Building Process (steps 1-3 of 6 total steps)</a></li>
<li class="chapter" data-level="17.1.2" data-path="arima-model-building.html"><a href="arima-model-building.html#model-building-process-continued-step-4."><i class="fa fa-check"></i><b>17.1.2</b> Model Building Process (continued, Step 4.)</a></li>
<li class="chapter" data-level="17.1.3" data-path="arima-model-building.html"><a href="arima-model-building.html#model-building-processcontinued-step-5."><i class="fa fa-check"></i><b>17.1.3</b> Model Building Process(continued, Step 5.)</a></li>
<li class="chapter" data-level="17.1.4" data-path="arima-model-building.html"><a href="arima-model-building.html#model-building-process-continued-step-6."><i class="fa fa-check"></i><b>17.1.4</b> Model Building Process (continued, Step 6.)</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="arima-model-building.html"><a href="arima-model-building.html#example"><i class="fa fa-check"></i><b>17.2</b> Example</a></li>
<li class="chapter" data-level="17.3" data-path="arima-model-building.html"><a href="arima-model-building.html#model-building-process-summarized"><i class="fa fa-check"></i><b>17.3</b> Model Building Process Summarized</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sarima-models.html"><a href="sarima-models.html"><i class="fa fa-check"></i><b>18</b> SARIMA Models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sarima-models.html"><a href="sarima-models.html#introduction-and-simulated-example"><i class="fa fa-check"></i><b>18.1</b> Introduction and Simulated Example</a></li>
<li class="chapter" data-level="18.2" data-path="sarima-models.html"><a href="sarima-models.html#osu-example"><i class="fa fa-check"></i><b>18.2</b> OSU Example</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="arfima.html"><a href="arfima.html"><i class="fa fa-check"></i><b>19</b> ARFIMA</a>
<ul>
<li class="chapter" data-level="19.1" data-path="arfima.html"><a href="arfima.html#introduction-and-simulated-example-1"><i class="fa fa-check"></i><b>19.1</b> Introduction and Simulated Example</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="arfima.html"><a href="arfima.html#the-pi_js"><i class="fa fa-check"></i><b>19.1.1</b> The <span class="math inline">\(\pi_j\)</span>’s</a></li>
<li class="chapter" data-level="19.1.2" data-path="arfima.html"><a href="arfima.html#finding-estimatet-of-d"><i class="fa fa-check"></i><b>19.1.2</b> Finding estimatet of d:</a></li>
<li class="chapter" data-level="19.1.3" data-path="arfima.html"><a href="arfima.html#fractional-arimapdq-or-arfima-model"><i class="fa fa-check"></i><b>19.1.3</b> Fractional ARIMA(p,d,q) or ARFIMA model</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="arfima.html"><a href="arfima.html#additional-example"><i class="fa fa-check"></i><b>19.2</b> Additional Example</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="regression-with-arma-errors.html"><a href="regression-with-arma-errors.html"><i class="fa fa-check"></i><b>20</b> Regression with ARMA Errors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="regression-with-arma-errors.html"><a href="regression-with-arma-errors.html#model-building-for-regression-models-with-arma-errors"><i class="fa fa-check"></i><b>20.1</b> Model building for regression models with ARMA errors</a></li>
<li class="chapter" data-level="20.2" data-path="regression-with-arma-errors.html"><a href="regression-with-arma-errors.html#forecasting-for-regression-models-with-arma-errors"><i class="fa fa-check"></i><b>20.2</b> Forecasting for regression models with ARMA errors</a></li>
<li class="chapter" data-level="20.3" data-path="regression-with-arma-errors.html"><a href="regression-with-arma-errors.html#additional-comments"><i class="fa fa-check"></i><b>20.3</b> Additional comments</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="multiple-time-series.html"><a href="multiple-time-series.html"><i class="fa fa-check"></i><b>21</b> Multiple Time Series</a>
<ul>
<li class="chapter" data-level="21.1" data-path="multiple-time-series.html"><a href="multiple-time-series.html#cross-covariance-function-and-cross-correlation-function"><i class="fa fa-check"></i><b>21.1</b> Cross-covariance function and Cross-correlation function</a></li>
<li class="chapter" data-level="21.2" data-path="multiple-time-series.html"><a href="multiple-time-series.html#stationarity-2"><i class="fa fa-check"></i><b>21.2</b> Stationarity</a></li>
<li class="chapter" data-level="21.3" data-path="multiple-time-series.html"><a href="multiple-time-series.html#estimation-1"><i class="fa fa-check"></i><b>21.3</b> Estimation</a></li>
<li class="chapter" data-level="21.4" data-path="multiple-time-series.html"><a href="multiple-time-series.html#vector-time-series"><i class="fa fa-check"></i><b>21.4</b> Vector time series</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="arch-models.html"><a href="arch-models.html"><i class="fa fa-check"></i><b>22</b> ARCH Models</a>
<ul>
<li class="chapter" data-level="22.1" data-path="arch-models.html"><a href="arch-models.html#arch-models--introduction"><i class="fa fa-check"></i><b>22.1</b> ARCH Models- Introduction</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="arch-models.html"><a href="arch-models.html#when-to-use-this-models"><i class="fa fa-check"></i><b>22.1.1</b> When to use this models?</a></li>
<li class="chapter" data-level="22.1.2" data-path="arch-models.html"><a href="arch-models.html#arch1-model"><i class="fa fa-check"></i><b>22.1.2</b> ARCH(1) model</a></li>
<li class="chapter" data-level="22.1.3" data-path="arch-models.html"><a href="arch-models.html#parameter-estimation"><i class="fa fa-check"></i><b>22.1.3</b> Parameter estimation</a></li>
<li class="chapter" data-level="22.1.4" data-path="arch-models.html"><a href="arch-models.html#archm-model"><i class="fa fa-check"></i><b>22.1.4</b> ARCH(m) model</a></li>
<li class="chapter" data-level="22.1.5" data-path="arch-models.html"><a href="arch-models.html#weaknesses-of-arch-models"><i class="fa fa-check"></i><b>22.1.5</b> Weaknesses of ARCH models</a></li>
<li class="chapter" data-level="22.1.6" data-path="arch-models.html"><a href="arch-models.html#garchmr"><i class="fa fa-check"></i><b>22.1.6</b> GARCH(m,r)</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="arch-models.html"><a href="arch-models.html#simulated-example"><i class="fa fa-check"></i><b>22.2</b> Simulated Example</a></li>
<li class="chapter" data-level="22.3" data-path="arch-models.html"><a href="arch-models.html#arch-models-arima"><i class="fa fa-check"></i><b>22.3</b> ARCH Models: ARIMA</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="arch-models.html"><a href="arch-models.html#model-building"><i class="fa fa-check"></i><b>22.3.1</b> Model Building</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="garch-models.html"><a href="garch-models.html"><i class="fa fa-check"></i><b>23</b> GARCH Models</a>
<ul>
<li class="chapter" data-level="23.1" data-path="garch-models.html"><a href="garch-models.html#garchm-r"><i class="fa fa-check"></i><b>23.1</b> GARCH(m, r)</a></li>
<li class="chapter" data-level="23.2" data-path="garch-models.html"><a href="garch-models.html#final-comments"><i class="fa fa-check"></i><b>23.2</b> Final Comments</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html"><i class="fa fa-check"></i><b>24</b> More Time Series Analysis</a>
<ul>
<li class="chapter" data-level="24.1" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#threshold-models"><i class="fa fa-check"></i><b>24.1</b> Threshold Models</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#threshold-autoregressive-models"><i class="fa fa-check"></i><b>24.1.1</b> Threshold autoregressive models</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#intervention-analysis"><i class="fa fa-check"></i><b>24.2</b> Intervention analysis</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#types-of-intervention-variables"><i class="fa fa-check"></i><b>24.2.1</b> Types of intervention variables</a></li>
<li class="chapter" data-level="24.2.2" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#possible-responses-to-interventions"><i class="fa fa-check"></i><b>24.2.2</b> Possible responses to interventions</a></li>
<li class="chapter" data-level="24.2.3" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#multiple-interventions"><i class="fa fa-check"></i><b>24.2.3</b> Multiple interventions</a></li>
<li class="chapter" data-level="24.2.4" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#modeling"><i class="fa fa-check"></i><b>24.2.4</b> Modeling</a></li>
<li class="chapter" data-level="24.2.5" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#outliers"><i class="fa fa-check"></i><b>24.2.5</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#transfer-function-models"><i class="fa fa-check"></i><b>24.3</b> Transfer function models</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#general-concepts"><i class="fa fa-check"></i><b>24.3.1</b> General concepts</a></li>
<li class="chapter" data-level="24.3.2" data-path="more-time-series-analysis.html"><a href="more-time-series-analysis.html#trandfer-function"><i class="fa fa-check"></i><b>24.3.2</b> Trandfer function</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sarima-models" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> SARIMA Models<a href="sarima-models.html#sarima-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-and-simulated-example" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Introduction and Simulated Example<a href="sarima-models.html#introduction-and-simulated-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Time series data often has a pattern which repeats every s time periods. For example, monthly data may have s = 12.</p>
<p>Seasonal ARIMA (SARIMA) models can be found using the same techniques as discussed previously. A model that only has seasonal components is written as</p>
<p><span class="math display">\[\Phi(B^s)(1-B^s)^Dx_t=\Theta(B^s)w_t\]</span></p>
<p>where <span class="math inline">\(w_t \sim ind.(0, \sigma_w^2)\)</span> and <span class="math inline">\(\Phi(B^s)=1-\Phi_1B^s-\Phi_2B^{2s}-...-\Phi_PB^{Ps}, \Theta(B^s)=1+\Theta_1B^s+\Theta_2B^{2s}+...+\Theta_QB^{Qs}\)</span></p>
<p>Notice how s is used above! If s = 1, we have the “usual” non-seasonal model. Also, the “Q” here is not for the Ljung-Box-Pierce test!</p>
<p>The seasonal differencing operator <span class="math inline">\((1-B^s)^D\)</span> means that for D = 1,<span class="math inline">\((1-B^s)^1x_t=x_t-x_{t-s}\)</span>.</p>
<p>In a purely seasonal ARIMA model (no non-seasonal components), the ACF and PACF have similar forms as for the previous non-seasonal ARIMA models. The difference is now only lags h = s, 2s, 3s, … are examined. The remainder of the lags have autocorrelations and partial autocorrelations equal to 0. Below is a table summarizing the results.</p>
<table>
<colgroup>
<col width="23%" />
<col width="23%" />
<col width="23%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>AR(P)s</th>
<th>MA(Q)s</th>
<th>ARMA(P,Q)s</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ACF</td>
<td>Tails off to 0 at lags ks for k=1,2,…</td>
<td>Cuts off to 0 after lag Qs</td>
<td>Tails off to 0 after lag Qs</td>
</tr>
<tr class="even">
<td>PACF</td>
<td>Cuts off to 0 after lag Ps</td>
<td>Tails off to 0 at lags ks for k=1,2,…</td>
<td>Tails off to 0 after lag Ps</td>
</tr>
</tbody>
</table>
<p>The ks term is multiple of s.</p>
<p>For example,</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>ACF</th>
<th>PACF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Seasonal AR(1): <span class="math inline">\((1-\Phi_1B^s)x_t=w_t\)</span></td>
<td><span class="math inline">\(\rho(sh)=\Phi_1^h\)</span></td>
<td><span class="math inline">\(\phi_{sh,sh}=\begin{cases} \Phi_1 &amp; h=1 \\ 0 &amp; h \ge 2 \end{cases}\)</span></td>
</tr>
</tbody>
</table>
<p>Nonseasonal patterns can be present with seasonal patterns! The ARIMA(p,d,q)x(P,D,Q)<span class="math inline">\(_s\)</span> model is</p>
<p><span class="math display">\[\Phi(B^s)\phi(B)(1-B^s)^D(1-B)^dx_t=\Theta(B^s)\theta(B)w_t\]</span></p>
<p>where <span class="math inline">\(w_t \sim ind.(0, \sigma_w^2)\)</span></p>
<p>The ACF and PACF plots are combinations of the ACF and PACFs from both the seasonal and non-seasonal parts of the model. This can make examining ACF and PACF plots (for determining p, q, P, and Q) quite complicated! Typically, this is the order one proceeds in when trying to determine a SARIMA model:</p>
<ol style="list-style-type: decimal">
<li>Investigate any nonstationarity problems and try to solve them. For example, nonstationarity in the mean would appear as (s = 4):</li>
</ol>
<p><img src="SARIMA-graph1.png" /></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Determine P and Q; one may need to examine residual ACF and PACF plots in an iterative manner to choose good values.</p></li>
<li><p>Investigate residual ACF and PACF plots to determine p and q; again, plots for multiple models may need to be examined in an iterative manner.</p></li>
</ol>
<p>Seasonal models can become even more complicated.</p>
<p><span class="math display">\[\prod^{M}_{j=1}\phi_j(B^{s_j})\prod_{i=1}^{K}(1-B^{s_i})^{D_i}x_t=\prod_{k=1}^{R}\theta_k(B^{s_k})w_t\]</span>
where <span class="math inline">\(\phi_j(B^{s_j})=(1-\phi_{j,1}B^{s_j}-...-\phi_{j,p_j}B^{s_jp_j}), \theta_k(B^{s_k})=(1+\theta_{k,1}B^{s_k}+...+\theta_{k,q_k}B^{s_kq_k})\)</span></p>
<p>Thus, the above representation can incorporate seasonality in more than one way. The <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\Theta\)</span> notation is not used so that a more general representation of the model can be given.</p>
<p>Below are a few examples where SARIMA models would be appropriate.</p>
<div class="example">
<p><span id="exm:unlabeled-div-1" class="example"><strong>Example 18.1  </strong></span><strong>Sunspots (sunspots.R)</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sarima-models.html#cb1-1" aria-hidden="true" tabindex="-1"></a>sunspots <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">&quot;SN_y_tot_V2.0.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb1-2"><a href="sarima-models.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Mid.year&quot;</span>, <span class="st">&quot;Mean.total&quot;</span>, <span class="st">&quot;Mean.SD.total&quot;</span>, <span class="st">&quot;Numb.obs.used&quot;</span>, <span class="st">&quot;Definitive&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="sarima-models.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> sunspots<span class="sc">$</span>Mean.total, <span class="at">x =</span> sunspots<span class="sc">$</span>Mid.year, <span class="at">ylab =</span> <span class="st">&quot;Number of sunspots&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb2-2"><a href="sarima-models.html#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Sunspots per year from 1700 to 2020&quot;</span>,</span>
<span id="cb2-3"><a href="sarima-models.html#cb2-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb2-4"><a href="sarima-models.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">y =</span> sunspots<span class="sc">$</span>Mean.total, <span class="at">x =</span> sunspots<span class="sc">$</span>Mid.year, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>There are approximately a 10-12 year cycle between peaks (highs) and valleys (lows).</p>
<p>s <span class="math inline">\(\approx\)</span> 10-12</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-2" class="example"><strong>Example 18.2  </strong></span><strong>OSU enrollment data (osu_enroll.R)</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sarima-models.html#cb3-1" aria-hidden="true" tabindex="-1"></a>osu.enroll <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;OSU_enroll.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-2"><a href="sarima-models.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="sarima-models.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="sarima-models.html#cb3-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> osu.enroll<span class="sc">$</span>Enrollment</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="sarima-models.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="st">&quot;OSU Enrollment&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;t (time)&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb4-2"><a href="sarima-models.html#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;OSU enrollment data&quot;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb4-3"><a href="sarima-models.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sarima-models.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#More complicated plot</span></span>
<span id="cb5-2"><a href="sarima-models.html#cb5-2" aria-hidden="true" tabindex="-1"></a>fall <span class="ot">&lt;-</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Fall&quot;</span>,]</span>
<span id="cb5-3"><a href="sarima-models.html#cb5-3" aria-hidden="true" tabindex="-1"></a>spring <span class="ot">&lt;-</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Spring&quot;</span>,]</span>
<span id="cb5-4"><a href="sarima-models.html#cb5-4" aria-hidden="true" tabindex="-1"></a>summer <span class="ot">&lt;-</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Summer&quot;</span>,]</span>
<span id="cb5-5"><a href="sarima-models.html#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="sarima-models.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> fall<span class="sc">$</span>Enrollment, <span class="at">x =</span> fall<span class="sc">$</span>t,</span>
<span id="cb5-7"><a href="sarima-models.html#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;OSU Enrollment&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;t (time)&quot;</span>, </span>
<span id="cb5-8"><a href="sarima-models.html#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb5-9"><a href="sarima-models.html#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;OSU Enrollment from Fall 1989 to Fall 2002&quot;</span>, </span>
<span id="cb5-10"><a href="sarima-models.html#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>), </span>
<span id="cb5-11"><a href="sarima-models.html#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(osu.enroll<span class="sc">$</span>Enrollment)))</span>
<span id="cb5-12"><a href="sarima-models.html#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="sarima-models.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> spring<span class="sc">$</span>Enrollment, <span class="at">x =</span> spring<span class="sc">$</span>t, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb5-14"><a href="sarima-models.html#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">2</span>)</span>
<span id="cb5-15"><a href="sarima-models.html#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="sarima-models.html#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> summer<span class="sc">$</span>Enrollment, <span class="at">x =</span> summer<span class="sc">$</span>t, <span class="at">col =</span> </span>
<span id="cb5-17"><a href="sarima-models.html#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;darkgreen&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">3</span>)</span>
<span id="cb5-18"><a href="sarima-models.html#cb5-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-19"><a href="sarima-models.html#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">&quot;center&quot;</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">&quot;Fall&quot;</span>,<span class="st">&quot;Spring&quot;</span>,<span class="st">&quot;Summer&quot;</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>s=3</p>
</div>
<p>Notes:</p>
<ul>
<li>Large estimated autocorrelations are often present surrounding the seasonal lags.<br />
</li>
<li>Strong seasonal variation often causes large estimated autocorrelations at fractional multiples (1/2, 1/3, etc.) of the seasonal lags.</li>
</ul>
<div class="example">
<p><span id="exm:unlabeled-div-3" class="example"><strong>Example 18.3  </strong></span><strong>ARIMA(0,1,1)x(0,1,1)<span class="math inline">\(_{12}\)</span> (sarima_011_011_12_sim.R)</strong></p>
<p>Suppose I want to simulate n = 200 observations from the above process with <span class="math inline">\(\sigma_w^2= 25, \mu = 0, \theta_1 = -0.4,\)</span> and
<span class="math inline">\(\Theta_1 = -0.6.\)</span></p>
<p>The process can be written so that only <span class="math inline">\(x_t\)</span> is on the left side.</p>
<p><span class="math display">\[(1-B)(1-B^{12})x_t=(1+\theta_1B)(1+\Theta_1B^{12})w_t\\
\implies (1-B)(x_t-x_{t-12})=(1+\theta_1B)(w_t+\Theta_1w_{t-12})\\
\implies x_t-x_{t-12}-x_{t-1}+x_{t-13}=w_t+\Theta_1w_{t-12}+\theta_1w_{t-1}+\theta_1\Theta_1w_{t-13}\\
\implies x_t=x_{t-1}+x_{t-12}-x_{t-13}+w_t+\theta_1w_{t-1}+\Theta_1w_{t-12}+\theta_1\Theta_1w_{t-13}\]</span></p>
<p>Using <code>ARMAacf()</code>, we can see what the ACF and PACF is for model with <strong>d = 0, D = 0</strong>, q = 1, and Q = 1. Because the function does not have a direct way to input the seasonal portion, we need to multiply out the MA operators, <span class="math inline">\((1 - 0.4B)(1 - 0.6B^{12}) = 1 - 0.4B - 0.6B^{12} + 0.24B^{13}\)</span> and use this form in the <code>ma</code> argument of <code>ARMAacf()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sarima-models.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-2"><a href="sarima-models.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice the use of rep()</span></span>
<span id="cb6-3"><a href="sarima-models.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> <span class="fu">ARMAacf</span>(<span class="at">ma =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fu">rep</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="dv">10</span>), </span>
<span id="cb6-4"><a href="sarima-models.html#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.24</span>), <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">pacf =</span> <span class="cn">FALSE</span>), <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span>, </span>
<span id="cb6-5"><a href="sarima-models.html#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">ylab =</span> </span>
<span id="cb6-6"><a href="sarima-models.html#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="fu">rho</span>(h)), <span class="at">main =</span> <span class="st">&quot;True ACF for </span></span>
<span id="cb6-7"><a href="sarima-models.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">    ARIMA(1,0,1)x(0,0,1)_12&quot;</span>)</span>
<span id="cb6-8"><a href="sarima-models.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb6-9"><a href="sarima-models.html#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="sarima-models.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">ARMAacf</span>(<span class="at">ma =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fu">rep</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="dv">10</span>), </span>
<span id="cb6-11"><a href="sarima-models.html#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.24</span>), <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">pacf =</span> <span class="cn">TRUE</span>), <span class="at">type =</span> </span>
<span id="cb6-12"><a href="sarima-models.html#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;h&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">ylab =</span> </span>
<span id="cb6-13"><a href="sarima-models.html#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expression</span>(phi1[hh]),<span class="at">main =</span> <span class="st">&quot;True PACF for </span></span>
<span id="cb6-14"><a href="sarima-models.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st">    ARIMA(1,0,1)x(0,0,1)_12&quot;</span>)</span>
<span id="cb6-15"><a href="sarima-models.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>As we mentioned earlier, large estimated autocorrelations (see lag 11 and 13) are often present surrounding the seasonal lags (which is lag s=12 here) (i.e. 在seasonal lag 附近的ACF也會比較高). This occurs b/c in the above we can write the model in this way <span class="math inline">\((1 - 0.4B)(1 - 0.6B^{12}) = 1 - 0.4B - 0.6B^{12} + 0.24B^{13}\)</span>.</p>
<p>In fact, this is also true for the PACF, you can see large estimated PACF around lag 12 and its multiple 24, 36, 48,…
(check h=10, 11, 22, 23, 34, 35,…)</p>
<p>For MA(Q=1), we expect the PACF tails off to 0 at lags ks for k=1,2,…, here s=12.</p>
<p>Also notice that for lag h=0~10, you can see them as non-seasonal components.</p>
<p>To simulate data from the model, <code>arima.sim()</code> can be used; however, not in as easy a way as one would expect. Below are a few notes:</p>
<ul>
<li>Multiply out the AR and MA operators and incorporate these into one <code>list()</code> statement in <code>arima.sim().</code><br />
</li>
<li>Program the model into R and use the <code>for()</code> function to loop over its components in a similar manner to what we did for the AR(1) example.</li>
<li>Use a user-written package. The <code>astsa</code> package includes the <code>sarima.sim()</code> function for this purpose. An example is given at the end of the program.</li>
</ul>
<p>I simulated observations from the model in the past and put them into a comma delimited file. I am going to use this data for the rest of the example. An additional <strong>24 additional observations were simulated at the end of the t = 1, …, 200 series so that forecasted values can be compared to the true future values.</strong> Below is the code needed to read and plot the data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sarima-models.html#cb7-1" aria-hidden="true" tabindex="-1"></a>sarima.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;sarima011.011.12.csv&quot;</span>) </span>
<span id="cb7-2"><a href="sarima-models.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sarima.data)</span></code></pre></div>
<pre><code>##           x time
## 1 -167.6940    1
## 2 -171.0745    2
## 3 -168.8319    3
## 4 -172.4671    4
## 5 -172.4534    5
## 6 -191.5866    6</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sarima-models.html#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> sarima.data<span class="sc">$</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>]</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sarima-models.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot of the data</span></span>
<span id="cb10-2"><a href="sarima-models.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, type </span>
<span id="cb10-3"><a href="sarima-models.html#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Data simulated from </span></span>
<span id="cb10-4"><a href="sarima-models.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">    ARIMA(0,1,1)x(0,1,1)_12&quot;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> </span>
<span id="cb10-5"><a href="sarima-models.html#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb10-6"><a href="sarima-models.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>I also constructed another plot of the data using the gridlines to determine the seasonal behavior (looks like s = 12).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="sarima-models.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Put gridlines at every 12th time point on the x-axis</span></span>
<span id="cb11-2"><a href="sarima-models.html#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="sarima-models.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The xaxt = &quot;n&quot; option prevents the x-axis tick marks </span></span>
<span id="cb11-4"><a href="sarima-models.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># from being drawn </span></span>
<span id="cb11-5"><a href="sarima-models.html#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="sarima-models.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> </span>
<span id="cb11-7"><a href="sarima-models.html#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span>  </span>
<span id="cb11-8"><a href="sarima-models.html#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Data simulated from ARIMA(0,1,1)x(0,1,1)_12&quot;</span>)</span>
<span id="cb11-9"><a href="sarima-models.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb11-10"><a href="sarima-models.html#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="sarima-models.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#x-axis </span></span>
<span id="cb11-12"><a href="sarima-models.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Major and minor tick marks - see intro. to R examples</span></span>
<span id="cb11-13"><a href="sarima-models.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">192</span>, <span class="at">by =</span> <span class="dv">12</span>)) </span>
<span id="cb11-14"><a href="sarima-models.html#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb11-15"><a href="sarima-models.html#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tck =</span> <span class="fl">0.01</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>) </span>
<span id="cb11-16"><a href="sarima-models.html#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">192</span>, <span class="at">by =</span> <span class="dv">12</span>), <span class="at">lty =</span> </span>
<span id="cb11-17"><a href="sarima-models.html#cb11-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb11-18"><a href="sarima-models.html#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="sarima-models.html#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#y-axis </span></span>
<span id="cb11-20"><a href="sarima-models.html#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">350</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">150</span>, <span class="at">by =</span> <span class="dv">50</span>), <span class="at">lty =</span> </span>
<span id="cb11-21"><a href="sarima-models.html#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Next are the plots of the estimated ACF and PACF. Notice the <code>lag.max</code> command is used to increase the number of lags shown on the plot. This is helpful to see a seasonal pattern. Obviously, the data is nonstationary in the mean.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="sarima-models.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of x_t</span></span>
<span id="cb12-2"><a href="sarima-models.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb12-3"><a href="sarima-models.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="at">x =</span> x, <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">ylim =</span> </span>
<span id="cb12-4"><a href="sarima-models.html#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated ACF plot </span></span>
<span id="cb12-5"><a href="sarima-models.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">    for &quot;</span>, x[t])))</span>
<span id="cb12-6"><a href="sarima-models.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="at">x =</span> x, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb12-7"><a href="sarima-models.html#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated PACF plot for &quot;</span>, </span>
<span id="cb12-8"><a href="sarima-models.html#cb12-8" aria-hidden="true" tabindex="-1"></a>    x[t])))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>There are two ways to take care of the nonstationarity:</p>
<ol style="list-style-type: decimal">
<li>Find the first differences: (1-B)</li>
<li>Determine if seasonal differences are needed: <span class="math inline">\((1-B^s)\)</span></li>
</ol>
<p>The ACF plot is showing a “slightly higher” value at every 12th autocorrelation. This possibly shows that <span class="math inline">\((1-B^{12})\)</span> is needed. In addition, the ACF at all lags is going slowly to 0 indicating that (1-B) is needed. I decided to look at this type of differences first.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sarima-models.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of (1-B)*x_t</span></span>
<span id="cb13-2"><a href="sarima-models.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-3"><a href="sarima-models.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">1</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">type =</span> </span>
<span id="cb13-4"><a href="sarima-models.html#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">ylim =</span> </span>
<span id="cb13-5"><a href="sarima-models.html#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. ACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span></span>
<span id="cb13-6"><a href="sarima-models.html#cb13-6" aria-hidden="true" tabindex="-1"></a>    B)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span>
<span id="cb13-7"><a href="sarima-models.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">1</span>, <span class="at">differences =</span> <span class="dv">1</span>), lag.max </span>
<span id="cb13-8"><a href="sarima-models.html#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> <span class="dv">50</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb13-9"><a href="sarima-models.html#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. PACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>x[t], </span>
<span id="cb13-10"><a href="sarima-models.html#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot; data&quot;</span>)))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The ACF plot definitely shows a 12 lag pattern of very high autocorrelations. This suggests that <span class="math inline">\((1-B^{12})\)</span> should also be examined.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sarima-models.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of (1-B^12)*x_t</span></span>
<span id="cb14-2"><a href="sarima-models.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb14-3"><a href="sarima-models.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">12</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), </span>
<span id="cb14-4"><a href="sarima-models.html#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. ACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">12</span>)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span>
<span id="cb14-5"><a href="sarima-models.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pacf</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">12</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb14-6"><a href="sarima-models.html#cb14-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. PACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">12</span>)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sarima-models.html#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Below is the code used to examine the results of <span class="math inline">\((1-B^{12})(1-B)x_t\)</span>. Notice how the <code>diff()</code> function is used.</p>
<p><code>x2 &lt;- diff(x = diff(x = x, lag = 12, differences = 1), lag = 1, differences = 1)</code></p>
<p>The diff inside deal with seasonal part: x_t - x_{t-12} and the diff outside deal with non-seasonal part, which one you want to deal with first doesn’t matter.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sarima-models.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of (1-B)(1-B^12)*x_t</span></span>
<span id="cb16-2"><a href="sarima-models.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb16-3"><a href="sarima-models.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="sarima-models.html#cb16-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">12</span>, <span class="at">differences =</span> <span class="dv">1</span>), </span>
<span id="cb16-5"><a href="sarima-models.html#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag =</span> <span class="dv">1</span>, <span class="at">differences =</span> <span class="dv">1</span>)</span>
<span id="cb16-6"><a href="sarima-models.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="at">x =</span> x2, <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">xlim =</span> </span>
<span id="cb16-7"><a href="sarima-models.html#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>( </span>
<span id="cb16-8"><a href="sarima-models.html#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Est. ACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">12</span>)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)), </span>
<span id="cb16-9"><a href="sarima-models.html#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb16-10"><a href="sarima-models.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="at">x =</span> x2, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">ylim =</span> </span>
<span id="cb16-11"><a href="sarima-models.html#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. </span></span>
<span id="cb16-12"><a href="sarima-models.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">    PACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">12</span>)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)), </span>
<span id="cb16-13"><a href="sarima-models.html#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>In the Est.ACF plot, look at lag:0~10, these are for the non-seasonal part, same for the PACF plot. As for lag 12, large estimated ACF indicate the seasonal part, and we did not see large estimated ACF at multiple of 12 b/c we’ve done differencing. Also, large estimated ACF was found at lag 11, this is nothing special as we mentioned before, we usually have large ACF surrounding the seasonality lag.</p>
<p>Same thing occurs in PACF plot large estimated PACF occur surrounding the multiple of the seasonality lag, nothing to worry about.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sarima-models.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot of the differenced data  </span></span>
<span id="cb17-2"><a href="sarima-models.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x2, <span class="at">ylab =</span> <span class="fu">expression</span>((<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">12</span>)<span class="sc">*</span>x[t]), </span>
<span id="cb17-3"><a href="sarima-models.html#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb17-4"><a href="sarima-models.html#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span>  <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span></span>
<span id="cb17-5"><a href="sarima-models.html#cb17-5" aria-hidden="true" tabindex="-1"></a>    B<span class="sc">^</span><span class="dv">12</span>)<span class="sc">*</span>x[t])))</span>
<span id="cb17-6"><a href="sarima-models.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> x2, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb17-7"><a href="sarima-models.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">192</span>, <span class="at">by =</span> <span class="dv">12</span>)) </span>
<span id="cb17-8"><a href="sarima-models.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb17-9"><a href="sarima-models.html#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tck =</span> <span class="fl">0.01</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>) </span>
<span id="cb17-10"><a href="sarima-models.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">192</span>, <span class="at">by =</span> <span class="dv">12</span>), <span class="at">lty =</span> </span>
<span id="cb17-11"><a href="sarima-models.html#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb17-12"><a href="sarima-models.html#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">10</span>), <span class="at">lty =</span> </span>
<span id="cb17-13"><a href="sarima-models.html#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>There is no longer a nonstationary behavior in the resulting time series data. The PACF plot shows definite significant values at lag 1, 12, and 13. A few other partial autocorrelations may be significant also. The ACF has significant autocorrelations at lag 1 and 12. This indicates that an ARIMA(0,1,1)x(0,1,1)<span class="math inline">\(_{12}\)</span> should be examined. Also, this assumes the PACF behavior is tailing off to 0 for lag 12, 24, … and lag 1, 2, … . Note that there may be justification for other models with P = 1 or 2 and p = 1. I will examine an ARIMA(0,1,<strong>0</strong>)x(0,1,1)<span class="math inline">\(_{12}\)</span> model and determine from the residuals if any changes need to be made. The q = 1 is not used because I would like to get the seasonal part of the model figured out first. Below is the code and output. Notice the syntax used with the <code>arima()</code> function to fit the SARIMA model.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sarima-models.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit model to data</span></span>
<span id="cb18-2"><a href="sarima-models.html#cb18-2" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="fl">010.011</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb18-3"><a href="sarima-models.html#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>))</span>
<span id="cb18-4"><a href="sarima-models.html#cb18-4" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="fl">010.011</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 0), seasonal = list(order = c(0, 1, 1), period = 12))
## 
## Coefficients:
##          sma1
##       -0.6447
## s.e.   0.0605
## 
## sigma^2 estimated as 32.46:  log likelihood = -593.95,  aic = 1191.89</code></pre>
<ul>
<li><p><span class="math inline">\(\hat \Theta_1=-0.6447\)</span></p></li>
<li><p><span class="math inline">\(\sqrt{\hat Var(\hat \Theta_1)}=0.0605\)</span></p></li>
<li><p><span class="math inline">\(\hat \sigma_w^2=32.46\)</span></p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sarima-models.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;examine.mod.R&quot;</span>)</span>
<span id="cb20-2"><a href="sarima-models.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Need to run function in examine.mod.R file first</span></span>
<span id="cb20-3"><a href="sarima-models.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit.<span class="fl">010.011</span>, </span>
<span id="cb20-4"><a href="sarima-models.html#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,1,0)x(0,1,1)_12&quot;</span>, <span class="at">max.lag =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-16-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<pre><code>## $z
##      sma1 
## -10.65188 
## 
## $p.value
## sma1 
##    0</code></pre>
<p>Notice in the ACF of Residuals plot, we see large ACF at lag 1, indicating q=1 may be needed. Also note that the p-values for Kjung-Boc statistic are very small, this is no good.You should also notice the estimated PACF are tailing off after lag 1.</p>
<p>The residual ACF and PACF show no more signs of a seasonal pattern! It is too bad that R does not allow one to automatically use a larger number of lags on the ACF plot (see the R help for how the number of lags displayed is determined). The <span class="math inline">\(\Theta_1\)</span> is significantly different from 0. The ACF has a significant autocorrelation at lag 1 and the PACF appears to be tailing off to 0. Therefore, the model ARIMA(0,1,1)x(0,1,1)<span class="math inline">\(_{12}\)</span> will be tried. Below is the code and output.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="sarima-models.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ARIMA(0,1,1)x(0,1,1)_12</span></span>
<span id="cb22-2"><a href="sarima-models.html#cb22-2" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="fl">011.011</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb22-3"><a href="sarima-models.html#cb22-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>))</span>
<span id="cb22-4"><a href="sarima-models.html#cb22-4" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="fl">011.011</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 12))
## 
## Coefficients:
##           ma1     sma1
##       -0.4113  -0.6347
## s.e.   0.0680   0.0617
## 
## sigma^2 estimated as 28.19:  log likelihood = -580.72,  aic = 1167.44</code></pre>
<ul>
<li><p><span class="math inline">\(\hat \theta_1=-0.4113\)</span></p></li>
<li><p><span class="math inline">\(\hat \Theta_1=-0.6347\)</span></p></li>
<li><p><span class="math inline">\(\hat \sigma_w^2=28.19\)</span></p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="sarima-models.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit.<span class="fl">011.011</span>, <span class="at">mod.name =</span> </span>
<span id="cb24-2"><a href="sarima-models.html#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ARIMA(0,1,1)x(0,1,1)_12&quot;</span>, <span class="at">max.lag =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-18-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<pre><code>## $z
##        ma1       sma1 
##  -6.051257 -10.285054 
## 
## $p.value
##        ma1       sma1 
## 1.4372e-09 0.0000e+00</code></pre>
<p>The residual ACF and PACF appear to be similar to the same plots resulting from a white noise process. The <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\theta_1\)</span> are significantly different from 0. There are no extreme standardized residuals. The residual histogram and Q-Q plot maybe show some non-normality on the tails of the distribution, but it is not too bad. Remember the data was simulated using a normal distribution so this is a good example of something to not be concerned about! The histogram may also include too many classes for the x-axis. Below is a plot of the same residuals now with less classes (see program for code).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sarima-models.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x =</span> mod.fit.<span class="fl">011.011</span><span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;Histogram of residuals&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">breaks =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sarima-models.html#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(<span class="at">x =</span> mod.fit.<span class="fl">011.011</span><span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;Histogram of residuals&quot;</span>,</span>
<span id="cb27-2"><a href="sarima-models.html#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">15</span>, <span class="at">to =</span> <span class="dv">15</span>, <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb27-3"><a href="sarima-models.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="at">expr =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(mod.fit.<span class="fl">011.011</span><span class="sc">$</span>residuals),</span>
<span id="cb27-4"><a href="sarima-models.html#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(mod.fit.<span class="fl">011.011</span><span class="sc">$</span>residuals)), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>The Ljung-Box-Pierce test indicates there is not sufficient evidence of non-zero autocorrelations.</p>
<p>Therefore, my final estimated model is</p>
<p><span class="math display">\[(1-B^{12})(1-B)x_t=(1-0.6347B^{12})(1-0.4113B)w_t\]</span>
where <span class="math inline">\(\hat \sigma_w^2=28.19\)</span></p>
<p>Compare how close these parameter estimates are to what was used to generate the data!</p>
<p>If I did not know what the model should have been at the beginning, it would have been very reasonable to investigate other models indicated previously. If more than one model passed all of the diagnostic tests, I would have used the AIC to help pick the best model.</p>
<p>Forecasts are found for 24 time periods into the future. Notice this corresponds to just 2 “seasons” into the future.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sarima-models.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Forecasts 24 time periods into the future</span></span>
<span id="cb28-2"><a href="sarima-models.html#cb28-2" aria-hidden="true" tabindex="-1"></a>fore.mod <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> mod.fit.<span class="fl">011.011</span>, <span class="at">n.ahead =</span> </span>
<span id="cb28-3"><a href="sarima-models.html#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">24</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>) </span>
<span id="cb28-4"><a href="sarima-models.html#cb28-4" aria-hidden="true" tabindex="-1"></a>fore.mod</span></code></pre></div>
<pre><code>## $pred
## Time Series:
## Start = 201 
## End = 224 
## Frequency = 1 
##  [1] -317.5528 -330.8742 -352.8390 -344.9029 -332.8707 -348.5246 -348.1134
##  [8] -352.1134 -351.7119 -350.6458 -352.5155 -346.0474 -328.9166 -342.2380
## [15] -364.2027 -356.2667 -344.2345 -359.8884 -359.4772 -363.4771 -363.0757
## [22] -362.0096 -363.8793 -357.4111
## 
## $se
## Time Series:
## Start = 201 
## End = 224 
## Frequency = 1 
##  [1]  5.309460  6.161149  6.908628  7.582779  8.201703  8.777090  9.317011
##  [8]  9.827313 10.312394 10.775661 11.219815 11.647044 12.700809 13.398572
## [15] 14.061753 14.695035 15.302131 15.886044 16.449241 16.993784 17.521412
## [22] 18.033608 18.531654 19.016660</code></pre>
<ul>
<li><p><span class="math inline">\(\tilde x^{200}_{201}=-317.5528\)</span></p></li>
<li><p><span class="math inline">\(\tilde x^{200}_{224}=-357.4111\)</span></p></li>
<li><p><span class="math inline">\(\sqrt{\hat Var(x_{201}-\tilde x^{200}_{201})}=5.309460\)</span></p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sarima-models.html#cb30-1" aria-hidden="true" tabindex="-1"></a>pred.mod <span class="ot">&lt;-</span> x <span class="sc">-</span> mod.fit.<span class="fl">011.011</span><span class="sc">$</span>residuals</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sarima-models.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate 95% C.I.s </span></span>
<span id="cb31-2"><a href="sarima-models.html#cb31-2" aria-hidden="true" tabindex="-1"></a>low <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb31-3"><a href="sarima-models.html#cb31-3" aria-hidden="true" tabindex="-1"></a>up <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb31-4"><a href="sarima-models.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(low, up)</span></code></pre></div>
<pre><code>##          low        up
## 1  -327.9592 -307.1465
## 2  -342.9499 -318.7986
## 3  -366.3796 -339.2983
## 4  -359.7649 -330.0410
## 5  -348.9458 -316.7957
## 6  -365.7274 -331.3218
## 7  -366.3744 -329.8524
## 8  -371.3745 -332.8522
## 9  -371.9239 -331.5000
## 10 -371.7657 -329.5259
## 11 -374.5060 -330.5251
## 12 -368.8751 -323.2196
## 13 -353.8097 -304.0235
## 14 -368.4987 -315.9773
## 15 -391.7633 -336.6422
## 16 -385.0685 -327.4650
## 17 -374.2261 -314.2429
## 18 -391.0245 -328.7523
## 19 -391.7171 -327.2373
## 20 -396.7843 -330.1699
## 21 -397.4171 -328.7344
## 22 -397.3548 -326.6643
## 23 -400.2007 -327.5580
## 24 -394.6831 -320.1392</code></pre>
<p><span class="math inline">\(-327.9593&lt;x_{201}&lt;-307.1465\)</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sarima-models.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#When I originally simulated the data, 224 observations </span></span>
<span id="cb33-2"><a href="sarima-models.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#were actually simulated. I did this so that I could </span></span>
<span id="cb33-3"><a href="sarima-models.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#examine how well the confidence intervals captured </span></span>
<span id="cb33-4"><a href="sarima-models.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#the true future values.</span></span>
<span id="cb33-5"><a href="sarima-models.html#cb33-5" aria-hidden="true" tabindex="-1"></a>x.extra <span class="ot">&lt;-</span> sarima.data<span class="sc">$</span>x[<span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>]</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sarima-models.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> </span>
<span id="cb34-2"><a href="sarima-models.html#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;o&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">400</span>, <span class="sc">-</span><span class="dv">150</span>), </span>
<span id="cb34-3"><a href="sarima-models.html#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">224</span>), <span class="at">main =</span>  <span class="st">&quot;Forecast plot&quot;</span>)</span>
<span id="cb34-4"><a href="sarima-models.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">224</span>, <span class="at">by =</span> <span class="dv">12</span>), </span>
<span id="cb34-5"><a href="sarima-models.html#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">las =</span> <span class="dv">2</span>) <span class="co">#las makes the labels vertical</span></span>
<span id="cb34-6"><a href="sarima-models.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">224</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb34-7"><a href="sarima-models.html#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tck =</span> <span class="fl">0.01</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>) </span>
<span id="cb34-8"><a href="sarima-models.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">224</span>, <span class="at">by =</span> <span class="dv">12</span>), <span class="at">lty =</span> </span>
<span id="cb34-9"><a href="sarima-models.html#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb34-10"><a href="sarima-models.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">400</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">150</span>, <span class="at">by =</span> <span class="dv">50</span>), <span class="at">lty =</span> </span>
<span id="cb34-11"><a href="sarima-models.html#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb34-12"><a href="sarima-models.html#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="sarima-models.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Predicted values for t = 1, ..., 200 and forecasts for </span></span>
<span id="cb34-14"><a href="sarima-models.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  t = 201, ..., 224</span></span>
<span id="cb34-15"><a href="sarima-models.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(pred.mod, fore.mod<span class="sc">$</span>pred), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> </span>
<span id="cb34-16"><a href="sarima-models.html#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;black&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">17</span>) </span>
<span id="cb34-17"><a href="sarima-models.html#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="sarima-models.html#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="sarima-models.html#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Forecasts and C.I.s</span></span>
<span id="cb34-20"><a href="sarima-models.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> low, <span class="at">x =</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb34-21"><a href="sarima-models.html#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb34-22"><a href="sarima-models.html#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> up, <span class="at">x =</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb34-23"><a href="sarima-models.html#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb34-24"><a href="sarima-models.html#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="sarima-models.html#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="sarima-models.html#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Actual future values</span></span>
<span id="cb34-27"><a href="sarima-models.html#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> x.extra, <span class="at">x =</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb34-28"><a href="sarima-models.html#cb34-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>) </span>
<span id="cb34-29"><a href="sarima-models.html#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="sarima-models.html#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Legend</span></span>
<span id="cb34-31"><a href="sarima-models.html#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, </span>
<span id="cb34-32"><a href="sarima-models.html#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;95% C.I.&quot;</span>, <span class="st">&quot;Actual future values&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, </span>
<span id="cb34-33"><a href="sarima-models.html#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;solid&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, </span>
<span id="cb34-34"><a href="sarima-models.html#cb34-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="cn">NA</span>, <span class="dv">20</span>), <span class="at">bty =</span> </span>
<span id="cb34-35"><a href="sarima-models.html#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>This is hard to see so I created another plot that zoomed in on the right side. Please see the program for the code.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sarima-models.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Zoom in</span></span>
<span id="cb35-2"><a href="sarima-models.html#cb35-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb35-3"><a href="sarima-models.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot of forecasts, C.I.s, and true future values.</span></span>
<span id="cb35-4"><a href="sarima-models.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.new(width = 8, height = 6, pointsize = 10)</span></span>
<span id="cb35-5"><a href="sarima-models.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="sarima-models.html#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">400</span>, <span class="sc">-</span><span class="dv">250</span>),</span>
<span id="cb35-7"><a href="sarima-models.html#cb35-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">190</span>, <span class="dv">224</span>), <span class="at">main =</span>  <span class="st">&quot;Forecast plot&quot;</span>)</span>
<span id="cb35-8"><a href="sarima-models.html#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="sarima-models.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">#These are the same axis() and abline() functions as done in the previous plot</span></span>
<span id="cb35-10"><a href="sarima-models.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  R will still line up everything correctly with what is given in the current plot()</span></span>
<span id="cb35-11"><a href="sarima-models.html#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">224</span>, <span class="at">by =</span> <span class="dv">12</span>)) </span>
<span id="cb35-12"><a href="sarima-models.html#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">224</span>, <span class="at">by =</span> <span class="dv">2</span>), <span class="at">tck =</span> <span class="fl">0.01</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>) </span>
<span id="cb35-13"><a href="sarima-models.html#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">224</span>, <span class="at">by =</span> <span class="dv">12</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb35-14"><a href="sarima-models.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">400</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">150</span>, <span class="at">by =</span> <span class="dv">50</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb35-15"><a href="sarima-models.html#cb35-15" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb35-16"><a href="sarima-models.html#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Predicted values for t = 1, ..., 200 </span></span>
<span id="cb35-17"><a href="sarima-models.html#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co"># and forecasts for t = 201, ..., 224</span></span>
<span id="cb35-18"><a href="sarima-models.html#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(pred.mod, fore.mod<span class="sc">$</span>pred), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">17</span>) </span>
<span id="cb35-19"><a href="sarima-models.html#cb35-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-20"><a href="sarima-models.html#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Forecasts and C.I.s</span></span>
<span id="cb35-21"><a href="sarima-models.html#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> low, <span class="at">x =</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb35-22"><a href="sarima-models.html#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> up, <span class="at">x =</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb35-23"><a href="sarima-models.html#cb35-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-24"><a href="sarima-models.html#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Actual future values</span></span>
<span id="cb35-25"><a href="sarima-models.html#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> x.extra, <span class="at">x =</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">224</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>) </span>
<span id="cb35-26"><a href="sarima-models.html#cb35-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-27"><a href="sarima-models.html#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Legend</span></span>
<span id="cb35-28"><a href="sarima-models.html#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, <span class="st">&quot;95% C.I.&quot;</span>, <span class="st">&quot;Actual future values&quot;</span>), </span>
<span id="cb35-29"><a href="sarima-models.html#cb35-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;solid&quot;</span>),</span>
<span id="cb35-30"><a href="sarima-models.html#cb35-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="cn">NA</span>, <span class="dv">20</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Notice that all of the actual values are within the 95% C.I.s!</p>
<p>What if <span class="math inline">\(\delta\)</span> was estimated? The term ends up being highly non-significant as shown in the output below.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="sarima-models.html#cb36-1" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="dv">011</span>.<span class="fl">011.</span>delta <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb36-2"><a href="sarima-models.html#cb36-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), </span>
<span id="cb36-3"><a href="sarima-models.html#cb36-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">xreg =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb36-4"><a href="sarima-models.html#cb36-4" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="dv">011</span>.<span class="fl">011.</span>delta </span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 12), 
##     xreg = 1:length(x))
## 
## Coefficients:</code></pre>
<pre><code>## Warning in sqrt(diag(x$var.coef)): NaNs produced</code></pre>
<pre><code>##           ma1     sma1  1:length(x)
##       -0.4113  -0.6347      -2.1554
## s.e.   0.0680   0.0617          NaN
## 
## sigma^2 estimated as 28.19:  log likelihood = -580.72,  aic = 1169.44</code></pre>
<p><span class="math inline">\(\hat \delta=-2.1554\)</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sarima-models.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit.<span class="dv">011</span>.<span class="fl">011.</span>delta, </span>
<span id="cb40-2"><a href="sarima-models.html#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,1,1)x(0,1,1)_12 with delta&quot;</span>, </span>
<span id="cb40-3"><a href="sarima-models.html#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.lag =</span> <span class="dv">50</span>)</span></code></pre></div>
<pre><code>## Warning in sqrt(diag(mod.fit.obj$var.coef)): NaNs produced</code></pre>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-28-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<pre><code>## $z
##         ma1        sma1 1:length(x) 
##   -6.051352  -10.286708         NaN 
## 
## $p.value
##          ma1         sma1  1:length(x) 
## 1.436353e-09 0.000000e+00          NaN</code></pre>
<p>The diagnostic plots are excluded from the notes.</p>
</div>
<p>Below we see how we can use the package <code>astsa</code> to simulate data.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sarima-models.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example way to simulate data from this model</span></span>
<span id="cb43-2"><a href="sarima-models.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="sarima-models.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="at">package =</span> astsa)</span>
<span id="cb43-4"><a href="sarima-models.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8239</span>)</span>
<span id="cb43-5"><a href="sarima-models.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sarima.sim</span>(<span class="at">d =</span> <span class="dv">1</span>, <span class="at">ma =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">D =</span> <span class="dv">1</span>, <span class="at">sma =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">S =</span> <span class="dv">12</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb43-6"><a href="sarima-models.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>## [1] 57.07862 58.87815 63.76458 57.06578 72.82324 75.33991</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="sarima-models.html#cb45-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb45-2"><a href="sarima-models.html#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span>  <span class="st">&quot;Data simulated from ARIMA(0,1,1)x(0,1,1)_12&quot;</span>,</span>
<span id="cb45-3"><a href="sarima-models.html#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb45-4"><a href="sarima-models.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sarima-models.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of x_t</span></span>
<span id="cb46-2"><a href="sarima-models.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.new(width = 8, height = 6, pointsize = 10)</span></span>
<span id="cb46-3"><a href="sarima-models.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb46-4"><a href="sarima-models.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(<span class="at">x =</span> x, <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated ACF plot for &quot;</span>, x[t])))</span>
<span id="cb46-5"><a href="sarima-models.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pacf</span>(<span class="at">x =</span> x, <span class="at">lag.max =</span> <span class="dv">50</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated PACF plot for &quot;</span>, x[t])))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sarima-models.html#cb47-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Estimates are close to parameters</span></span>
<span id="cb47-2"><a href="sarima-models.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 12))
## 
## Coefficients:
##           ma1     sma1
##       -0.4209  -0.4958
## s.e.   0.0607   0.0629
## 
## sigma^2 estimated as 23.62:  log likelihood = -562.8,  aic = 1131.59</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="sarima-models.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example showing how NOT to simulate SARIMA data</span></span>
<span id="cb49-2"><a href="sarima-models.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="sarima-models.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Code simulates some observations, but what model??? </span></span>
<span id="cb49-4"><a href="sarima-models.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1890</span>)</span>
<span id="cb49-5"><a href="sarima-models.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ma =</span> <span class="sc">-</span><span class="fl">0.4</span>), <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ma =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">period =</span> <span class="dv">12</span>)),</span>
<span id="cb49-6"><a href="sarima-models.html#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">200</span>, <span class="at">rand.gen =</span> rnorm, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb49-7"><a href="sarima-models.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co">#Notice that x_1 is missing</span></span></code></pre></div>
<pre><code>##  [1]  3.6785060 -7.6322208 -0.6449263 -4.9990844  0.7669400  5.8649723
##  [7]  1.6828721  0.6659346 -3.1937851  0.6594206</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sarima-models.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot of the data</span></span>
<span id="cb51-2"><a href="sarima-models.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.new(width = 8, height = 6, pointsize = 10)</span></span>
<span id="cb51-3"><a href="sarima-models.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb51-4"><a href="sarima-models.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>),  </span>
<span id="cb51-5"><a href="sarima-models.html#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span>  <span class="st">&quot;Data simulated from ARIMA(0,1,1)x(0,1,1)_12&quot;</span>,</span>
<span id="cb51-6"><a href="sarima-models.html#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb51-7"><a href="sarima-models.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sarima-models.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit model to data </span></span>
<span id="cb52-2"><a href="sarima-models.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># notice how far off the estimates are from the parameters.  </span></span>
<span id="cb52-3"><a href="sarima-models.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 12))
## 
## Coefficients:
##           ma1     sma1
##       -1.0000  -1.0000
## s.e.   0.0658   0.0696
## 
## sigma^2 estimated as 22.26:  log likelihood = -576.56,  aic = 1159.12</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="sarima-models.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 1))
## 
## Coefficients:
##           ma1
##       -1.0000
## s.e.   0.0155
## 
## sigma^2 estimated as 22.1:  log likelihood = -593.01,  aic = 1190.01</code></pre>
</div>
<div id="osu-example" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> OSU Example<a href="sarima-models.html#osu-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="example">
<p><span id="exm:unlabeled-div-4" class="example"><strong>Example 18.4  </strong></span><strong>OSU enrollment data(osu_enroll_MB.R)</strong></p>
<p>The Office of Planning, Budget, and Institutional Research (OPBIR) makes fall semester enrollment forecasts in their annual Student Profile report. At the beginning of the course, we examined an O’Colly article which discussed these forecasts. In particular, the forecast for fall 2000 was 743 students too high resulting in a $1.8 million tuition shortfall. According to an official OPBIR document, forecasts were made using the following method:</p>
<blockquote>
<p>New freshmen projections are based on an expected market share of projected Oklahoma ACT test takers. On-campus sophomore, junior and senior projections are based on cohort survival rates using an average of the previous three years. OSU-Tulsa undergraduates are projected to increase approximately 5% per year.</p>
</blockquote>
<p>According to OPBIR, the enrollment data was collected as close to the final Drop and Add Day as possible.</p>
<p>For this analysis, I am going to use data up to the spring 2002 semester only to simulate what would be available for wanting to forecast fall 2002. Below are the estimated ACF and PACF plots of the data.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="sarima-models.html#cb56-1" aria-hidden="true" tabindex="-1"></a>osu.enroll <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;OSU_enroll.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-2"><a href="sarima-models.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(osu.enroll)</span></code></pre></div>
<pre><code>##   t Semester Year Enrollment      date
## 1 1     Fall 1989      20110 8/31/1989
## 2 2   Spring 1990      19128  2/1/1990
## 3 3   Summer 1990       7553  6/1/1990
## 4 4     Fall 1990      19591 8/31/1990
## 5 5   Spring 1991      18361  2/1/1991
## 6 6   Summer 1991       6702  6/1/1991</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="sarima-models.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(osu.enroll)</span></code></pre></div>
<pre><code>##     t Semester Year Enrollment      date
## 35 35   Spring 2001      20004  2/1/2001
## 36 36   Summer 2001       7558  6/1/2001
## 37 37     Fall 2001      21872 8/31/2001
## 38 38   Spring 2002      20922  2/1/2002
## 39 39   Summer 2002       7868  6/1/2002
## 40 40     Fall 2002      22992 8/31/2002</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="sarima-models.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose it was early spring 2002 and you wanted to </span></span>
<span id="cb60-2"><a href="sarima-models.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast fall 2002 so use data only up to spring 2002</span></span>
<span id="cb60-3"><a href="sarima-models.html#cb60-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> osu.enroll<span class="sc">$</span>Enrollment[<span class="dv">1</span><span class="sc">:</span><span class="dv">38</span>]  </span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="sarima-models.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width = 8, height = 6, pointsize = 10) </span></span>
<span id="cb61-2"><a href="sarima-models.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#width = 6 is default so this makes it wider</span></span>
<span id="cb61-3"><a href="sarima-models.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="st">&quot;OSU Enrollment&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;t (time)&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb61-4"><a href="sarima-models.html#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;OSU enrollment data&quot;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb61-5"><a href="sarima-models.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="sarima-models.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of x_t</span></span>
<span id="cb62-2"><a href="sarima-models.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb62-3"><a href="sarima-models.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="at">x =</span> x, <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">ylim =</span> </span>
<span id="cb62-4"><a href="sarima-models.html#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated ACF plot </span></span>
<span id="cb62-5"><a href="sarima-models.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="st">    for &quot;</span>, x[t])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span>
<span id="cb62-6"><a href="sarima-models.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="at">x =</span> x, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb62-7"><a href="sarima-models.html#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated PACF plot for &quot;</span>, </span>
<span id="cb62-8"><a href="sarima-models.html#cb62-8" aria-hidden="true" tabindex="-1"></a>    x[t])))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>The autocorrelations are very slowly going to 0 for lag 3, 6, 9, … . Therefore, first differences should be examined for s = 3.</p>
<p>Suppose instead an ARIMA(0,0,0)x(1,0,0)<span class="math inline">\(_3\)</span> model was fit to the data. This may happen if the ACF plot was interpreted as tailing off to 0 and noticing the significant lag 3 partial autocorrelation.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sarima-models.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mod.fit.000.100 &lt;- arima(x = x, order = c(0, 0, 0), seasonal = list(order = c(1, 0, 0), period = 3))</span></span>
<span id="cb63-2"><a href="sarima-models.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mod.fit.000.100</span></span></code></pre></div>
<p>R gives an error message saying the model cannot be fit due to non-stationarity. For s = 3, first differences, <span class="math inline">\((1-B^3)\)</span>, could be interpreted as having a 1 coefficient on <span class="math inline">\(B^3\)</span>.</p>
<p>Below are the ACF and PACF plots after taking the first differences with s = 3.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="sarima-models.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ACF and PACF of (1-B^3)*x_t</span></span>
<span id="cb64-2"><a href="sarima-models.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">type =</span> </span>
<span id="cb64-3"><a href="sarima-models.html#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> </span>
<span id="cb64-4"><a href="sarima-models.html#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. ACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t], <span class="st">&quot; </span></span>
<span id="cb64-5"><a href="sarima-models.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="st">    data&quot;</span>)), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="sarima-models.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">1</span>), lag.max </span>
<span id="cb65-2"><a href="sarima-models.html#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> <span class="dv">20</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">main =</span></span>
<span id="cb65-3"><a href="sarima-models.html#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. PACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t],  </span>
<span id="cb65-4"><a href="sarima-models.html#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot; data&quot;</span>)))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<p>For the non-seasonal part, the ACF is tailing off to 0 and the PACF has a significant value at lag = 1. For the seasonal part, it looks like there may be a significant autocorrelation at lag 9. Possibly due to the small season length (s = 3), it may be hiding other significant values. Because I am not for sure, I decided to add an AR(1) term to the model for the non-seasonal part. Below is part of the output and code.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="sarima-models.html#cb66-1" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="fl">100.010</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb66-2"><a href="sarima-models.html#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb66-3"><a href="sarima-models.html#cb66-3" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="fl">100.010</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(1, 0, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##          ar1
##       0.6989
## s.e.  0.1278
## 
## sigma^2 estimated as 130905:  log likelihood = -256.19,  aic = 516.37</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="sarima-models.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Need to run function in examine.mod.R file first</span></span>
<span id="cb68-2"><a href="sarima-models.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit.<span class="fl">100.010</span>, <span class="at">mod.name =</span> </span>
<span id="cb68-3"><a href="sarima-models.html#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ARIMA(1,0,0)x(0,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-43-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-43-2.png" width="672" /></p>
<pre><code>## $z
##      ar1 
## 5.468632 
## 
## $p.value
##          ar1 
## 4.535231e-08</code></pre>
<p>Notes:</p>
<ul>
<li>Does the model make sense for this problem? Yes! For students in Spring, most of those same students are expected to still stay in Fall, so this one-period dependence can be captured by AR(1).</li>
<li>The test of <span class="math inline">\(H_0:\phi_1=0, H_a:\phi_1\ne 0\)</span> produces a test statistic of 0.6989/0.1278 = 5.47. Therefore, <span class="math inline">\(\phi_1\ne 0.\)</span></li>
<li>The residual ACF and PACF plots do not show any significantly different from 0 values.<br />
</li>
<li>The Ljung-Box-Pierce test also results in all “don’t reject Ho’s” for its test of non-zero autocorrelation.<br />
</li>
<li>There are no extreme standardized residuals.<br />
</li>
<li>There is some evidence against normality in the histogram and QQ-Plot. However, because the sample size is fairly small, I am not surprised by this and decided not to investigate transformations.<br />
</li>
<li>Because everything is o.k. with this model, one could use the final estimated model of an ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span>:</li>
</ul>
<p><span class="math inline">\((1-0.6989B)(1-B^3)x_t = w_t\)</span> with <span class="math inline">\(\hat \sigma_w^2=130,905\)</span></p>
</div>
<p>I still have some concerns about whether or not this is the best model that I could use. Below are some items that I tried first starting with just the <span class="math inline">\((1-B^3)x_t\)</span> series.</p>
<ol style="list-style-type: decimal">
<li>Remember seeing the marginally large autocorrelation at lag 9 for the <span class="math inline">\((1-B^3)x_t\)</span> series? Given s = 3, I decided to investigate adding seasonal MA terms to a model. The ARIMA(1,0,0)x(0,1,1)<span class="math inline">\(_3\)</span> model results in a significant <span class="math inline">\(\Theta_1\)</span> and the residual ACF and PACF plots indicate either <span class="math inline">\(\phi_1\)</span> or <span class="math inline">\(\theta_1\)</span> should be added to the model. When <span class="math inline">\(\phi_1\)</span> is added to the model, <span class="math inline">\(\Theta_1\)</span> has a p-value of 0.11 and the AIC is 516 which is a little smaller than the 516.37 for the ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span> model.</li>
</ol>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="sarima-models.html#cb70-1" aria-hidden="true" tabindex="-1"></a>mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb70-2"><a href="sarima-models.html#cb70-2" aria-hidden="true" tabindex="-1"></a>mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(1, 0, 0), seasonal = list(order = c(0, 1, 1), period = 3))
## 
## Coefficients:
##          ar1    sma1
##       0.6879  0.3193
## s.e.  0.1280  0.2024
## 
## sigma^2 estimated as 120619:  log likelihood = -255,  aic = 516</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="sarima-models.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(1,0,0)x(0,1,1)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-45-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<pre><code>## $z
##      ar1     sma1 
## 5.374020 1.577184 
## 
## $p.value
##          ar1         sma1 
## 7.700036e-08 1.147532e-01</code></pre>
<p>When <span class="math inline">\(\theta_1\)</span> is added, <span class="math inline">\(\Theta_1\)</span> is no longer significant (p-value = 0.25) and there are marginally significant groups of autocorrelations as found by the Ljung-Box-Pierce test.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="sarima-models.html#cb74-1" aria-hidden="true" tabindex="-1"></a>mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb74-2"><a href="sarima-models.html#cb74-2" aria-hidden="true" tabindex="-1"></a>mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 0, 1), seasonal = list(order = c(0, 1, 1), period = 3))
## 
## Coefficients:
##          ma1    sma1
##       0.6303  0.2765
## s.e.  0.1252  0.2384
## 
## sigma^2 estimated as 135028:  log likelihood = -256.84,  aic = 519.68</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="sarima-models.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,0,1)x(0,1,1)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-47-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<pre><code>## $z
##      ma1     sma1 
## 5.033994 1.159878 
## 
## $p.value
##          ma1         sma1 
## 4.803635e-07 2.460984e-01</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Due to the significant autocorrelation at lag 1, I decided to start with a <span class="math inline">\(\theta_1\)</span>. The term is significant, but the Ljung-Box-Pierce test results in smaller p-values (some marginally significant?) than for the ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span> model. The ARIMA(0,0,1)x(0,1,0)<span class="math inline">\(_3\)</span> model’s AIC is 519.2 which is larger than the 516.37 for the ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span> model.</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="sarima-models.html#cb78-1" aria-hidden="true" tabindex="-1"></a>  mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb78-2"><a href="sarima-models.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 0, 1), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##          ma1
##       0.6935
## s.e.  0.1153
## 
## sigma^2 estimated as 141961:  log likelihood = -257.6,  aic = 519.2</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="sarima-models.html#cb80-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,0,1)x(0,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-49-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<pre><code>## $z
##      ma1 
## 6.015392 
## 
## $p.value
##         ma1 
## 1.79452e-09</code></pre>
<p>When both <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\phi_1\)</span> are in the model, <span class="math inline">\(\theta_1\)</span> is no longer significant.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="sarima-models.html#cb82-1" aria-hidden="true" tabindex="-1"></a>  mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb82-2"><a href="sarima-models.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(1, 0, 1), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##          ar1     ma1
##       0.5544  0.2463
## s.e.  0.3478  0.4910
## 
## sigma^2 estimated as 129731:  log likelihood = -256.04,  aic = 518.07</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="sarima-models.html#cb84-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(1,0,1)x(0,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-51-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
<pre><code>## $z
##       ar1       ma1 
## 1.5940900 0.5017557 
## 
## $p.value
##       ar1       ma1 
## 0.1109159 0.6158394</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>When <span class="math inline">\(\Phi_1\)</span> is in the model alone, it is marginally significant (p-value = 0.086) and the residual ACF and PACF’s indicate changes need to be made to the non-seasonal part of the model.</li>
</ol>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="sarima-models.html#cb86-1" aria-hidden="true" tabindex="-1"></a>  mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb86-2"><a href="sarima-models.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 0, 0), seasonal = list(order = c(1, 1, 0), period = 3))
## 
## Coefficients:
##         sar1
##       0.3198
## s.e.  0.1860
## 
## sigma^2 estimated as 219343:  log likelihood = -265.05,  aic = 534.09</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="sarima-models.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,0,0)x(1,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-53-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
<pre><code>## $z
##     sar1 
## 1.719011 
## 
## $p.value
##       sar1 
## 0.08561236</code></pre>
<p>When <span class="math inline">\(\phi_1\)</span> is added, <span class="math inline">\(\Phi_1\)</span> has a p-value of 0.15 and <span class="math inline">\(\phi_1\)</span> is highly significant. The AIC is 516.35.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="sarima-models.html#cb90-1" aria-hidden="true" tabindex="-1"></a>  mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb90-2"><a href="sarima-models.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(1, 0, 0), seasonal = list(order = c(1, 1, 0), period = 3))
## 
## Coefficients:
##          ar1    sar1
##       0.6858  0.2567
## s.e.  0.1283  0.1765
## 
## sigma^2 estimated as 122345:  log likelihood = -255.17,  aic = 516.35</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="sarima-models.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(1,0,0)x(1,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-55-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
<pre><code>## $z
##      ar1     sar1 
## 5.346115 1.454712 
## 
## $p.value
##          ar1         sar1 
## 8.986215e-08 1.457490e-01</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Below is a plot of <span class="math inline">\((1-B^3)x_t\)</span>:</li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="sarima-models.html#cb94-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#Plot of (1-B^3)*x_t </span></span>
<span id="cb94-2"><a href="sarima-models.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.new(width = 8, height = 6, pointsize = 10)</span></span>
<span id="cb94-3"><a href="sarima-models.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb94-4"><a href="sarima-models.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">ylab =</span> <span class="fu">expression</span>((<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,  </span>
<span id="cb94-5"><a href="sarima-models.html#cb94-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span>  <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t])), <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb94-6"><a href="sarima-models.html#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>This could indicate nonstationarity still exists and that differencing is needed. If one examined <span class="math inline">\((1-B)(1-B^3)x_t\)</span>, the following results</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="sarima-models.html#cb95-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#ACF and PACF of (1-B)*(1-B^3)*x_t</span></span>
<span id="cb95-2"><a href="sarima-models.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb95-3"><a href="sarima-models.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">1</span>), <span class="at">lag =</span> <span class="dv">1</span>, <span class="at">differences =</span> <span class="dv">1</span>)</span>
<span id="cb95-4"><a href="sarima-models.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(<span class="at">x =</span> x2, <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>),</span>
<span id="cb95-5"><a href="sarima-models.html#cb95-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. ACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span>
<span id="cb95-6"><a href="sarima-models.html#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pacf</span>(<span class="at">x =</span> x2, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb95-7"><a href="sarima-models.html#cb95-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. PACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="sarima-models.html#cb96-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#Plot of (1-B)*(1-B^3)*x_t </span></span>
<span id="cb96-2"><a href="sarima-models.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dev.new(width = 8, height = 6, pointsize = 10)</span></span>
<span id="cb96-3"><a href="sarima-models.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb96-4"><a href="sarima-models.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x2, <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t])), </span>
<span id="cb96-5"><a href="sarima-models.html#cb96-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="fu">expression</span>((<span class="dv">1</span><span class="sc">-</span>B)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>x[t]), <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb96-6"><a href="sarima-models.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> x2, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>While there is no longer the small upward trend in the plot of the data over time, the estimated ACF and PACF have no significant values. There does appear to be too many negative partial autocorrelations indicating there is some dependence left in the series. Also, the Ljung-Box-Pierce test indicates some marginally significant tests.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="sarima-models.html#cb97-1" aria-hidden="true" tabindex="-1"></a> mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb97-2"><a href="sarima-models.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## 
## sigma^2 estimated as 150974:  log likelihood = -250.97,  aic = 503.93</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="sarima-models.html#cb99-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,1,0)x(0,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-60-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-60-2.png" width="672" /></p>
<pre><code>## $z
## &lt;0 x 0 matrix&gt;
## 
## $p.value
## numeric(0)</code></pre>
<p>I tried a variety of ARIMA models with the data, but none produced significant AR or MA parameters. Also, I am a little concerned about doing the (1-B) difference considering the ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span> estimates <span class="math inline">\(\phi_1\)</span> to be 0.6989. Using the standard error, a 95% C.I. for <span class="math inline">\(\phi_1\)</span> is 0.6989 <span class="math inline">\(\pm\)</span> 1.96x0.1278 = (0.4484, 0.9494). So, there is not strong evidence to indicate <span class="math inline">\(\phi_1\)</span> = 1.</p>
<p>I did try to add additional terms to the model, but <span class="math inline">\(\phi_1\)</span> and <span class="math inline">\(\theta_1\)</span> are non-significant.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="sarima-models.html#cb101-1" aria-hidden="true" tabindex="-1"></a>mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb101-2"><a href="sarima-models.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(1, 1, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##           ar1
##       -0.1124
## s.e.   0.1703
## 
## sigma^2 estimated as 149011:  log likelihood = -250.75,  aic = 505.5</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="sarima-models.html#cb103-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(1,1,0)x(0,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-62-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-62-2.png" width="672" /></p>
<pre><code>## $z
##        ar1 
## -0.6597984 
## 
## $p.value
##       ar1 
## 0.5093832</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="sarima-models.html#cb105-1" aria-hidden="true" tabindex="-1"></a>mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb105-2"><a href="sarima-models.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##           ma1
##       -0.2048
## s.e.   0.2174
## 
## sigma^2 estimated as 147183:  log likelihood = -250.56,  aic = 505.11</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="sarima-models.html#cb107-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,1,1)x(0,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-64-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-64-2.png" width="672" /></p>
<pre><code>## $z
##        ma1 
## -0.9419347 
## 
## $p.value
##       ma1 
## 0.3462261</code></pre>
<p>Also, <span class="math inline">\(\Theta_1\)</span> has a p-value of 0.11 and <span class="math inline">\(\Phi_1\)</span> has a p-value of 0.15.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="sarima-models.html#cb109-1" aria-hidden="true" tabindex="-1"></a>mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb109-2"><a href="sarima-models.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 0), seasonal = list(order = c(0, 1, 1), period = 3))
## 
## Coefficients:
##         sma1
##       0.3016
## s.e.  0.1882
## 
## sigma^2 estimated as 139649:  log likelihood = -249.78,  aic = 503.57</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="sarima-models.html#cb111-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,1,0)x(0,1,1)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-66-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-66-2.png" width="672" /></p>
<pre><code>## $z
##     sma1 
## 1.602629 
## 
## $p.value
##      sma1 
## 0.1090165</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="sarima-models.html#cb113-1" aria-hidden="true" tabindex="-1"></a>mod.fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb113-2"><a href="sarima-models.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  mod.fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x, order = c(0, 1, 0), seasonal = list(order = c(1, 1, 0), period = 3))
## 
## Coefficients:
##         sar1
##       0.2455
## s.e.  0.1712
## 
## sigma^2 estimated as 141697:  log likelihood = -249.98,  aic = 503.96</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="sarima-models.html#cb115-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">examine.mod</span>(<span class="at">mod.fit.obj =</span> mod.fit, <span class="at">mod.name =</span> <span class="st">&quot;ARIMA(0,1,0)x(1,1,0)_3&quot;</span>, <span class="at">max.lag =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-68-1.png" width="672" /><img src="17-SARIMA_files/figure-html/unnamed-chunk-68-2.png" width="672" /></p>
<pre><code>## $z
##    sar1 
## 1.43425 
## 
## $p.value
##     sar1 
## 0.151501</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>(feel free to ignore this one, included here only to show how to write code with D&gt;1)</li>
</ol>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="sarima-models.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot of (1-B^3)^2*x_t </span></span>
<span id="cb117-2"><a href="sarima-models.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dev.new(width = 8, height = 6, pointsize = 10)</span></span>
<span id="cb117-3"><a href="sarima-models.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb117-4"><a href="sarima-models.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">2</span>), <span class="at">ylab =</span> <span class="fu">expression</span>((<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,  </span>
<span id="cb117-5"><a href="sarima-models.html#cb117-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span>  <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x[t])), <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb117-6"><a href="sarima-models.html#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">2</span>), <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="sarima-models.html#cb118-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#ACF and PACF of (1-B^3)^2*x_t</span></span>
<span id="cb118-2"><a href="sarima-models.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb118-3"><a href="sarima-models.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="at">x =</span> <span class="fu">diff</span>(<span class="at">x =</span> x, <span class="at">lag =</span> <span class="dv">3</span>, <span class="at">differences =</span> <span class="dv">2</span>), <span class="at">lag =</span> <span class="dv">1</span>, <span class="at">differences =</span> <span class="dv">1</span>)</span>
<span id="cb118-4"><a href="sarima-models.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">acf</span>(<span class="at">x =</span> x2, <span class="at">type =</span> <span class="st">&quot;correlation&quot;</span>, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>),</span>
<span id="cb118-5"><a href="sarima-models.html#cb118-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. ACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span>
<span id="cb118-6"><a href="sarima-models.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pacf</span>(<span class="at">x =</span> x2, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb118-7"><a href="sarima-models.html#cb118-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Est. PACF for &quot;</span>, (<span class="dv">1</span><span class="sc">-</span>B<span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x[t], <span class="st">&quot; data&quot;</span>)))</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>Below is the code and output for the forecasts using the ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span> model.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="sarima-models.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Forecasts 6 time periods into the future</span></span>
<span id="cb119-2"><a href="sarima-models.html#cb119-2" aria-hidden="true" tabindex="-1"></a>fore.mod <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> mod.fit.<span class="fl">100.010</span>, <span class="at">n.ahead =</span> </span>
<span id="cb119-3"><a href="sarima-models.html#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>) </span>
<span id="cb119-4"><a href="sarima-models.html#cb119-4" aria-hidden="true" tabindex="-1"></a>fore.mod</span></code></pre></div>
<pre><code>## $pred
## Time Series:
## Start = 39 
## End = 44 
## Frequency = 1 
## [1]  8199.614 22320.440 21235.426  8418.675 22473.548 21342.437
## 
## $se
## Time Series:
## Start = 39 
## End = 44 
## Frequency = 1 
## [1] 361.8086 441.4208 475.4894 679.4434 759.4145 795.5628</code></pre>
<p><span class="math inline">\(\tilde x^{38}_{39}=8199.614\)</span></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sarima-models.html#cb121-1" aria-hidden="true" tabindex="-1"></a>pred.mod <span class="ot">&lt;-</span> x <span class="sc">-</span> mod.fit.<span class="fl">100.010</span><span class="sc">$</span>residuals </span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="sarima-models.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate 95% C.I.s </span></span>
<span id="cb122-2"><a href="sarima-models.html#cb122-2" aria-hidden="true" tabindex="-1"></a>low <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> </span>
<span id="cb122-3"><a href="sarima-models.html#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>) <span class="sc">*</span> fore.mod<span class="sc">$</span>se</span>
<span id="cb122-4"><a href="sarima-models.html#cb122-4" aria-hidden="true" tabindex="-1"></a>up <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> </span>
<span id="cb122-5"><a href="sarima-models.html#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>) <span class="sc">*</span> fore.mod<span class="sc">$</span>se</span>
<span id="cb122-6"><a href="sarima-models.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(low, up)</span></code></pre></div>
<pre><code>##         low        up
## 1  7490.482  8908.745
## 2 21455.271 23185.609
## 3 20303.484 22167.368
## 4  7086.990  9750.360
## 5 20985.123 23961.973
## 6 19783.162 22901.711</code></pre>
<ul>
<li><p><span class="math inline">\(7490&lt;x_{39}&lt;8909\)</span></p></li>
<li><p><span class="math inline">\(21455&lt;x_{40}&lt;23185\)</span></p></li>
</ul>
<p>Below is a plot of the forecasts (see program for code).</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="sarima-models.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.new(width = 8, height = 8, pointsize = 10)</span></span>
<span id="cb124-2"><a href="sarima-models.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#par(mar =c(BELOW,LEFT,ABOVE,RIGHT)) #Space in margin</span></span>
<span id="cb124-3"><a href="sarima-models.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">1.5</span>,<span class="fl">1.5</span>))</span>
<span id="cb124-4"><a href="sarima-models.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">y =</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Fall&quot;</span> <span class="sc">&amp;</span> osu.enroll<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">39</span>,]<span class="sc">$</span>Enrollment, </span>
<span id="cb124-5"><a href="sarima-models.html#cb124-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Fall&quot;</span> <span class="sc">&amp;</span> osu.enroll<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">39</span>,]<span class="sc">$</span>t, </span>
<span id="cb124-6"><a href="sarima-models.html#cb124-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;t (time)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="st">&quot;OSU Enrollment&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">44</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>, </span>
<span id="cb124-7"><a href="sarima-models.html#cb124-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">17000</span>,<span class="dv">24000</span>), <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb124-8"><a href="sarima-models.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> <span class="fu">c</span>(pred.mod[<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">37</span>, <span class="at">by =</span> <span class="dv">3</span>)], fore.mod<span class="sc">$</span>pred[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)]), <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">44</span>, <span class="at">by =</span> <span class="dv">3</span>),   </span>
<span id="cb124-9"><a href="sarima-models.html#cb124-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">17</span>) </span>
<span id="cb124-10"><a href="sarima-models.html#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> low[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)], <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">43</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb124-11"><a href="sarima-models.html#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> up[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)], <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">43</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb124-12"><a href="sarima-models.html#cb124-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">y =</span> osu.enroll<span class="sc">$</span>Enrollment[<span class="dv">40</span>], <span class="at">x =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">2</span>) </span>
<span id="cb124-13"><a href="sarima-models.html#cb124-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">44</span>, <span class="at">by =</span> <span class="dv">3</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb124-14"><a href="sarima-models.html#cb124-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">17000</span>, <span class="at">to =</span> <span class="dv">23000</span>, <span class="at">by =</span> <span class="dv">2000</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb124-15"><a href="sarima-models.html#cb124-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">17500</span>, <span class="at">labels =</span> <span class="st">&quot;Fall Semester&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb124-16"><a href="sarima-models.html#cb124-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">23000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, <span class="st">&quot;95% C.I.&quot;</span>, <span class="st">&quot;Actual future values&quot;</span>), </span>
<span id="cb124-17"><a href="sarima-models.html#cb124-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="cn">NA</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="cn">NA</span>, <span class="dv">2</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb124-18"><a href="sarima-models.html#cb124-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-19"><a href="sarima-models.html#cb124-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-20"><a href="sarima-models.html#cb124-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-21"><a href="sarima-models.html#cb124-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-22"><a href="sarima-models.html#cb124-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-23"><a href="sarima-models.html#cb124-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>))</span>
<span id="cb124-24"><a href="sarima-models.html#cb124-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">y =</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Spring&quot;</span> <span class="sc">&amp;</span> osu.enroll<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">39</span>,]<span class="sc">$</span>Enrollment, </span>
<span id="cb124-25"><a href="sarima-models.html#cb124-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Spring&quot;</span> <span class="sc">&amp;</span> osu.enroll<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">39</span>,]<span class="sc">$</span>t, </span>
<span id="cb124-26"><a href="sarima-models.html#cb124-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;t (time)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">44</span>), <span class="at">las =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb124-27"><a href="sarima-models.html#cb124-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">17000</span>,<span class="dv">24000</span>), <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb124-28"><a href="sarima-models.html#cb124-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> <span class="fu">c</span>(pred.mod[<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">38</span>, <span class="at">by =</span> <span class="dv">3</span>)], fore.mod<span class="sc">$</span>pred[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>)]), <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">45</span>, <span class="at">by =</span> <span class="dv">3</span>),   </span>
<span id="cb124-29"><a href="sarima-models.html#cb124-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">17</span>) </span>
<span id="cb124-30"><a href="sarima-models.html#cb124-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#axis(side = 1, at = seq(from = 1, to = 42, by = 3)) </span></span>
<span id="cb124-31"><a href="sarima-models.html#cb124-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> low[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>)], <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">41</span>,<span class="dv">44</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb124-32"><a href="sarima-models.html#cb124-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> up[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>)], <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">41</span>,<span class="dv">44</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb124-33"><a href="sarima-models.html#cb124-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">44</span>, <span class="at">by =</span> <span class="dv">3</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb124-34"><a href="sarima-models.html#cb124-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">17000</span>, <span class="at">to =</span> <span class="dv">23000</span>, <span class="at">by =</span> <span class="dv">2000</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb124-35"><a href="sarima-models.html#cb124-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">17500</span>, <span class="at">labels =</span> <span class="st">&quot;Spring Semester&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb124-36"><a href="sarima-models.html#cb124-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">23000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, <span class="st">&quot;95% C.I.&quot;</span>, <span class="st">&quot;Actual future values&quot;</span>), </span>
<span id="cb124-37"><a href="sarima-models.html#cb124-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="cn">NA</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="cn">NA</span>, <span class="dv">2</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb124-38"><a href="sarima-models.html#cb124-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-39"><a href="sarima-models.html#cb124-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-40"><a href="sarima-models.html#cb124-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-41"><a href="sarima-models.html#cb124-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-42"><a href="sarima-models.html#cb124-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-43"><a href="sarima-models.html#cb124-43" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>))</span>
<span id="cb124-44"><a href="sarima-models.html#cb124-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">y =</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Summer&quot;</span> <span class="sc">&amp;</span> osu.enroll<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">39</span>,]<span class="sc">$</span>Enrollment, </span>
<span id="cb124-45"><a href="sarima-models.html#cb124-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> osu.enroll[osu.enroll<span class="sc">$</span>Semester <span class="sc">==</span> <span class="st">&quot;Summer&quot;</span> <span class="sc">&amp;</span> osu.enroll<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">39</span>,]<span class="sc">$</span>t, </span>
<span id="cb124-46"><a href="sarima-models.html#cb124-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;t (time)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">44</span>), <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb124-47"><a href="sarima-models.html#cb124-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">6000</span>,<span class="dv">10000</span>), <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb124-48"><a href="sarima-models.html#cb124-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> <span class="fu">c</span>(pred.mod[<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3</span>, <span class="at">to =</span> <span class="dv">36</span>, <span class="at">by =</span> <span class="dv">3</span>)], fore.mod<span class="sc">$</span>pred[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)]), <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3</span>, <span class="at">to =</span> <span class="dv">42</span>, <span class="at">by =</span> <span class="dv">3</span>),   </span>
<span id="cb124-49"><a href="sarima-models.html#cb124-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">17</span>) </span>
<span id="cb124-50"><a href="sarima-models.html#cb124-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">45</span>, <span class="at">by =</span> <span class="dv">3</span>)) </span>
<span id="cb124-51"><a href="sarima-models.html#cb124-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> low[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">39</span>,<span class="dv">42</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb124-52"><a href="sarima-models.html#cb124-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">y =</span> up[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">39</span>,<span class="dv">42</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb124-53"><a href="sarima-models.html#cb124-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">y =</span> osu.enroll<span class="sc">$</span>Enrollment[<span class="dv">39</span>], <span class="at">x =</span> <span class="dv">39</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">2</span>) </span>
<span id="cb124-54"><a href="sarima-models.html#cb124-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">44</span>, <span class="at">by =</span> <span class="dv">3</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb124-55"><a href="sarima-models.html#cb124-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">6000</span>, <span class="at">to =</span> <span class="dv">10000</span>, <span class="at">by =</span> <span class="dv">1000</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb124-56"><a href="sarima-models.html#cb124-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">6200</span>, <span class="at">labels =</span> <span class="st">&quot;Summer Semester&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb124-57"><a href="sarima-models.html#cb124-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">10000</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, <span class="st">&quot;95% C.I.&quot;</span>, <span class="st">&quot;Actual future values&quot;</span>), </span>
<span id="cb124-58"><a href="sarima-models.html#cb124-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="cn">NA</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">17</span>, <span class="cn">NA</span>, <span class="dv">2</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="17-SARIMA_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>Note that time = 40 is Fall 2002. Therefore, the forecasted enrollment for the Fall 2002 semester is 22,320. The actual enrollment was 22,992. The 95% C.I. is 21,455 <span class="math inline">\(\le x_{40} \le\)</span> 23,185. Perhaps this interval is too wide to be helpful. Alternatively, perhaps OSU could use the lower bound in its enrollment projections to be conservative.</p>
<p>Below is a table comparing the forecasts by OPBIR and my SARIMA model. The forecasts from my model are done using an ARIMA(1,0,0)x(0,1,0)<span class="math inline">\(_3\)</span>, but parameter estimates are found using data only up to the spring previous to the fall enrollment.</p>
<p>Here’s the codes for our SARIMA model.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sarima-models.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasts for fall 1998, fall 1999, fall 2000, fall 2001 using the </span></span>
<span id="cb125-2"><a href="sarima-models.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  ARIMA(1,0,0)x(0,1,0)_3 model with data only up to the previous spring semester</span></span>
<span id="cb125-3"><a href="sarima-models.html#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="sarima-models.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  mod.fit.<span class="dv">100</span>.<span class="fl">010.1998</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>], <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb125-5"><a href="sarima-models.html#cb125-5" aria-hidden="true" tabindex="-1"></a>  mod.fit.<span class="dv">100</span>.<span class="fl">010.1998</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x[1:26], order = c(1, 0, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##          ar1
##       0.5100
## s.e.  0.1885
## 
## sigma^2 estimated as 112365:  log likelihood = -166.53,  aic = 337.05</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sarima-models.html#cb127-1" aria-hidden="true" tabindex="-1"></a>  fore.mod <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> mod.fit.<span class="dv">100</span>.<span class="fl">010.1998</span>, <span class="at">n.ahead =</span> <span class="dv">2</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-2"><a href="sarima-models.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb127-3"><a href="sarima-models.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  up <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb127-4"><a href="sarima-models.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(low, up)</span></code></pre></div>
<pre><code>##         low        up
## 1  6216.471  7530.466
## 2 18741.250 20216.287</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sarima-models.html#cb129-1" aria-hidden="true" tabindex="-1"></a>mod.fit.<span class="dv">100</span>.<span class="fl">010.1999</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb129-2"><a href="sarima-models.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  mod.fit.<span class="dv">100</span>.<span class="fl">010.1999</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x[1:29], order = c(1, 0, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##          ar1
##       0.7353
## s.e.  0.1531
## 
## sigma^2 estimated as 130475:  log likelihood = -190.41,  aic = 384.82</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sarima-models.html#cb131-1" aria-hidden="true" tabindex="-1"></a>  fore.mod <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> mod.fit.<span class="dv">100</span>.<span class="fl">010.1999</span>, <span class="at">n.ahead =</span> <span class="dv">2</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-2"><a href="sarima-models.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb131-3"><a href="sarima-models.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  up <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb131-4"><a href="sarima-models.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(low, up)</span></code></pre></div>
<pre><code>##         low        up
## 1  7236.804  8652.735
## 2 20204.752 21962.297</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="sarima-models.html#cb133-1" aria-hidden="true" tabindex="-1"></a> mod.fit.<span class="dv">100</span>.<span class="fl">010.2000</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>], <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb133-2"><a href="sarima-models.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  mod.fit.<span class="dv">100</span>.<span class="fl">010.2000</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x[1:32], order = c(1, 0, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##         ar1
##       0.677
## s.e.  0.134
## 
## sigma^2 estimated as 127564:  log likelihood = -211.92,  aic = 427.85</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="sarima-models.html#cb135-1" aria-hidden="true" tabindex="-1"></a>  fore.mod <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> mod.fit.<span class="dv">100</span>.<span class="fl">010.2000</span>, <span class="at">n.ahead =</span> <span class="dv">2</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-2"><a href="sarima-models.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb135-3"><a href="sarima-models.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  up <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb135-4"><a href="sarima-models.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(low, up)</span></code></pre></div>
<pre><code>##         low        up
## 1  7053.457  8453.503
## 2 20411.222 22101.915</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="sarima-models.html#cb137-1" aria-hidden="true" tabindex="-1"></a>  mod.fit.<span class="dv">100</span>.<span class="fl">010.2001</span> <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="at">x =</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>], <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">3</span>))</span>
<span id="cb137-2"><a href="sarima-models.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  mod.fit.<span class="dv">100</span>.<span class="fl">010.2001</span></span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = x[1:35], order = c(1, 0, 0), seasonal = list(order = c(0, 1, 0), period = 3))
## 
## Coefficients:
##          ar1
##       0.6348
## s.e.  0.1337
## 
## sigma^2 estimated as 129450:  log likelihood = -234,  aic = 472</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="sarima-models.html#cb139-1" aria-hidden="true" tabindex="-1"></a>  fore.mod <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> mod.fit.<span class="dv">100</span>.<span class="fl">010.2001</span>, <span class="at">n.ahead =</span> <span class="dv">2</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-2"><a href="sarima-models.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb139-3"><a href="sarima-models.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  up <span class="ot">&lt;-</span> fore.mod<span class="sc">$</span>pred <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)<span class="sc">*</span>fore.mod<span class="sc">$</span>se</span>
<span id="cb139-4"><a href="sarima-models.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(low, up)</span></code></pre></div>
<pre><code>##         low        up
## 1  6604.105  8014.463
## 2 20484.836 22155.375</code></pre>
<p><strong>OPBIR</strong></p>
<table>
<thead>
<tr class="header">
<th>Semester</th>
<th>Actual</th>
<th>Forecast</th>
<th>Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fall 1998</td>
<td>20466</td>
<td>19490</td>
<td>976</td>
</tr>
<tr class="even">
<td>Fall 1999</td>
<td>21087</td>
<td>21072</td>
<td>15</td>
</tr>
<tr class="odd">
<td>Fall 2000</td>
<td>21252</td>
<td>21995</td>
<td>-743</td>
</tr>
<tr class="even">
<td>Fall 2001</td>
<td>21872</td>
<td>22377</td>
<td>-46</td>
</tr>
<tr class="odd">
<td>Fall 2002</td>
<td>22992</td>
<td>22377</td>
<td>615</td>
</tr>
</tbody>
</table>
<p><strong>SARIMA model</strong></p>
<table>
<thead>
<tr class="header">
<th>Semester</th>
<th>Actual</th>
<th>Forecast</th>
<th>Error</th>
<th>95% C.I.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fall 1998</td>
<td>20466</td>
<td>19478.77</td>
<td>987</td>
<td>(18,741, 20,216)</td>
</tr>
<tr class="even">
<td>Fall 1999</td>
<td>21087</td>
<td>21083.52</td>
<td>3</td>
<td>(20,205, 21,962)</td>
</tr>
<tr class="odd">
<td>Fall 2000</td>
<td>21252</td>
<td>21256.57</td>
<td>-5</td>
<td>(20,411, 22,102)</td>
</tr>
<tr class="even">
<td>Fall 2001</td>
<td>21872</td>
<td>21320.11</td>
<td>552</td>
<td>(20,485, 22,155)</td>
</tr>
<tr class="odd">
<td>Fall 2002</td>
<td>22992</td>
<td>22320.44</td>
<td>672</td>
<td>(21,455, 23,185)</td>
</tr>
</tbody>
</table>
<p>Notice how good the model did in fall 2000, which was the year discussed in the O’Colly article.</p>
<p>How do you measure which forecasting method is more accurate overall? One way is to look at the mean square error.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="sarima-models.html#cb141-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">976</span><span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">15</span><span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(<span class="sc">-</span><span class="dv">743</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(<span class="sc">-</span><span class="dv">46</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">615</span><span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 377038.2</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="sarima-models.html#cb143-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">987</span><span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">3</span><span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(<span class="sc">-</span><span class="dv">5</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">552</span><span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">672</span><span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 346098.2</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th>MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>OPBIR</td>
<td>377038</td>
</tr>
<tr class="even">
<td>SARIMA model</td>
<td>346046</td>
</tr>
</tbody>
</table>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arima-model-building.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arfima.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
